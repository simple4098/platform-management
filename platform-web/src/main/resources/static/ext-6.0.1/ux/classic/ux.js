Ext.define("Ext.ux.ajax.Simlet",function(){var B=/([^?#]*)(#.*)?$/,A=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,D=/^[+-]?\d+$/,C=/^[+-]?\d+\.\d+$/;function E(G){var F;if(Ext.isDefined(G)){G=decodeURIComponent(G);if(D.test(G)){G=parseInt(G,10)}else{if(C.test(G)){G=parseFloat(G)}else{if(!!(F=A.test(G))){G=new Date(Date.UTC(+F[1],+F[2]-1,+F[3],+F[4],+F[5],+F[6]))}}}}return G}return{alias:"simlet.basic",isSimlet:true,responseProps:["responseText","responseXML","status","statusText"],status:200,statusText:"OK",constructor:function(F){Ext.apply(this,F)},doGet:function(H){var F=this,G={};Ext.Array.forEach(F.responseProps,function(I){if(I in F){G[I]=F[I]}});return G},doPost:function(H){var F=this,G={};Ext.Array.forEach(F.responseProps,function(I){if(I in F){G[I]=F[I]}});return G},doRedirect:function(F){return false},doDelete:function(I){var G=this,H=I.xhr,F=H.options.records;G.removeFromData(I,F)},exec:function(I){var H=this,J={},F="do"+Ext.String.capitalize(I.method.toLowerCase()),G=H[F];if(G){J=G.call(H,H.getCtx(I.method,I.url,I))}else{J={status:405,statusText:"Method Not Allowed"}}return J},getCtx:function(H,G,F){return{method:H,params:this.parseQueryString(G),url:G,xhr:F}},openRequest:function(I,G,H,K){var L=this.getCtx(I,G),F=this.doRedirect(L),J;if(H.action==="destroy"){I="delete"}if(F){J=F}else{J=new Ext.ux.ajax.SimXhr({mgr:this.manager,simlet:this,options:H});J.open(I,G,K)}return J},parseQueryString:function(G){var L=B.exec(G),N={},M,H,I,J;if(L&&L[1]){var F,K=L[1].split("&");for(I=0,J=K.length;I<J;++I){if((F=K[I].split("="))[0]){M=decodeURIComponent(F.shift());H=E((F.length>1)?F.join("="):F[0]);if(!(M in N)){N[M]=H}else{if(Ext.isArray(N[M])){N[M].push(H)}else{N[M]=[N[M],H]}}}}}return N},redirect:function(G,F,H){switch(arguments.length){case 2:if(typeof F=="string"){break}H=F;case 1:F=G;G="GET";break}if(H){F=Ext.urlAppend(F,Ext.Object.toQueryString(H))}return this.manager.openRequest(G,F)},removeFromData:function(I,F){var H=this,K=H.getData(I),J=(I.xhr.options.proxy&&I.xhr.options.proxy.getModel())||{},G=J.idProperty||"id";Ext.each(F,function(M){var N=M.get(G);for(var L=K.length;L-->0;){if(K[L][G]===N){H.deleteRecord(L);break}}})}}}());Ext.define("Ext.ux.ajax.DataSimlet",function(){function A(F,E){var D=F.direction,C=(D&&D.toUpperCase()==="DESC")?-1:1;return function(G,I){var J=G[F.property],H=I[F.property],K=(J<H)?-1:((H<J)?1:0);if(K||!E){return K*C}return E(G,I)}}function B(E,F){for(var D=F,C=E&&E.length;C;){D=A(E[--C],D)}return D}return{extend:"Ext.ux.ajax.Simlet",buildNodes:function(H,I){var J=this,F={data:[]},K=H.length,E,G,D,C;J.nodes[I]=F;for(G=0;G<K;++G){F.data.push(D=H[G]);C=D.text||D.title;D.id=I?I+"/"+C:C;E=D.children;if(!(D.leaf=!E)){delete D.children;J.buildNodes(E,D.id)}}},deleteRecord:function(C){if(this.data&&typeof this.data!=="function"){Ext.Array.removeAt(this.data,C)}},fixTree:function(G,C){var E=this,D=G.params.node,F;if(!(F=E.nodes)){E.nodes=F={};E.buildNodes(C,"")}D=F[D];if(D){if(E.node){E.node.sortedData=E.sortedData;E.node.currentOrder=E.currentOrder}E.node=D;E.data=D.data;E.sortedData=D.sortedData;E.currentOrder=D.currentOrder}else{E.data=null}},getData:function(F){var C=this,K=F.params,H=(K.filter||"")+(K.group||"")+"-"+(K.sort||"")+"-"+(K.dir||""),I=C.tree,G,E,J,L;if(I){C.fixTree(F,I)}E=C.data;if(typeof E==="function"){G=true;E=E.call(this,F)}if(!E||H==="--"){return E||[]}if(!G&&H==C.currentOrder){return C.sortedData}F.filterSpec=K.filter&&Ext.decode(K.filter);F.groupSpec=K.group&&Ext.decode(K.group);J=K.sort;if(K.dir){J=[{direction:K.dir,property:J}]}else{J=Ext.decode(K.sort)}if(F.filterSpec){var D=new Ext.util.FilterCollection();D.add(this.processFilters(F.filterSpec));E=Ext.Array.filter(E,D.getFilterFn())}L=B((F.sortSpec=J));if(F.groupSpec){L=B([F.groupSpec],L)}E=Ext.isArray(E)?E.slice(0):E;if(L){Ext.Array.sort(E,L)}C.sortedData=E;C.currentOrder=H;return E},processFilters:Ext.identityFn,getPage:function(F,H){var D=H,C=H.length,G=F.params.start||0,E=F.params.limit?Math.min(C,G+F.params.limit):C;if(G||E<C){D=D.slice(G,E)}return D},getGroupSummary:function(E,C,D){return C[0]},getSummary:function(J,F,G){var L=this,I=J.groupSpec.property,C,D={},M=[],H,E;Ext.each(G,function(N){H=N[I];D[H]=true});function K(){if(C){M.push(L.getGroupSummary(I,C,J));C=null}}Ext.each(F,function(N){H=N[I];if(E!==H){K();E=H}if(!D[H]){return !M.length}if(C){C.push(N)}else{C=[N]}return true});K();return M}}}());Ext.define("Ext.ux.ajax.JsonSimlet",{extend:"Ext.ux.ajax.DataSimlet",alias:"simlet.json",doGet:function(D){var E=this,A=E.getData(D),B=E.getPage(D,A),F=D.xhr.options.proxy&&D.xhr.options.proxy.getReader(),C=F&&F.getRootProperty(),G=E.callParent(arguments),H={};if(C&&Ext.isArray(B)){H[C]=B;H[F.getTotalProperty()]=A.length}else{H=B}if(D.groupSpec){H.summaryData=E.getSummary(D,A,B)}G.responseText=Ext.encode(H);return G},doPost:function(A){return this.doGet(A)}});Ext.define("Ext.ux.ajax.SimXhr",{readyState:0,mgr:null,simlet:null,constructor:function(A){var B=this;Ext.apply(B,A);B.requestHeaders={}},abort:function(){var A=this;if(A.timer){clearTimeout(A.timer);A.timer=null}A.aborted=true},getAllResponseHeaders:function(){var A=[];if(Ext.isObject(this.responseHeaders)){Ext.Object.each(this.responseHeaders,function(B,C){A.push(B+": "+C)})}return A.join("\r\n")},getResponseHeader:function(B){var A=this.responseHeaders;return(A&&A[B])||null},open:function(D,B,E,F,A){var C=this;C.method=D;C.url=B;C.async=E!==false;C.user=F;C.password=A;C.setReadyState(1)},overrideMimeType:function(A){this.mimeType=A},schedule:function(){var A=this,B=A.mgr.delay;if(B){A.timer=setTimeout(function(){A.onTick()},B)}else{A.onTick()}},send:function(A){var B=this;B.body=A;if(B.async){B.schedule()}else{B.onComplete()}},setReadyState:function(B){var A=this;if(A.readyState!=B){A.readyState=B;A.onreadystatechange()}},setRequestHeader:function(A,B){this.requestHeaders[A]=B},onreadystatechange:Ext.emptyFn,onComplete:function(){var me=this,callback;me.readyState=4;Ext.apply(me,me.simlet.exec(me));callback=me.jsonpCallback;if(callback){var text=callback+"("+me.responseText+")";eval(text)}},onTick:function(){var A=this;A.timer=null;A.onComplete();A.onreadystatechange&&A.onreadystatechange()}});Ext.define("Ext.ux.ajax.SimManager",{singleton:true,requires:["Ext.data.Connection","Ext.ux.ajax.SimXhr","Ext.ux.ajax.Simlet","Ext.ux.ajax.JsonSimlet"],defaultType:"basic",delay:150,ready:false,constructor:function(){this.simlets=[]},getSimlet:function(H){var A=this,B=H.indexOf("?"),F=A.simlets,G=F.length,D,I,E,C;if(B<0){B=H.indexOf("#")}if(B>0){H=H.substring(0,B)}for(D=0;D<G;++D){I=F[D];E=I.url;if(E instanceof RegExp){C=E.test(H)}else{C=E===H}if(C){return I}}return A.defaultSimlet},getXhr:function(C,A,B,D){var E=this.getSimlet(A);if(E){return E.openRequest(C,A,B,D)}return null},init:function(A){var B=this;Ext.apply(B,A);if(!B.ready){B.ready=true;if(!("defaultSimlet" in B)){B.defaultSimlet=new Ext.ux.ajax.Simlet({status:404,statusText:"Not Found"})}B._openRequest=Ext.data.Connection.prototype.openRequest;Ext.data.request.Ajax.override({openRequest:function(D,C,F){var E=!D.nosim&&B.getXhr(C.method,C.url,D,F);if(!E){E=this.callParent(arguments)}return E}});if(Ext.data.JsonP){Ext.data.JsonP.self.override({createScript:function(C,G,D){var F=Ext.urlAppend(C,Ext.Object.toQueryString(G)),E=!D.nosim&&B.getXhr("GET",F,D,true);if(!E){E=this.callParent(arguments)}return E},loadScript:function(C){var D=C.script;if(D.simlet){D.jsonpCallback=C.params[C.callbackKey];D.send(null);C.script=document.createElement("script")}else{this.callParent(arguments)}}})}}return B},openRequest:function(B,A,C){var D={method:B,url:A};return this._openRequest.call(Ext.data.Connection.prototype,{},D,C)},register:function(C){var B=this;B.init();function A(E){var D=E;if(!D.isSimlet){D=Ext.create("simlet."+(D.type||D.stype||B.defaultType),E)}B.simlets.push(D);D.manager=B}if(Ext.isArray(C)){Ext.each(C,A)}else{if(C.isSimlet||C.url){A(C)}else{Ext.Object.each(C,function(D,E){E.url=D;A(E)})}}return B}});Ext.define("Ext.ux.ajax.XmlSimlet",{extend:"Ext.ux.ajax.DataSimlet",alias:"simlet.xml",xmlTpl:["<{root}>\n",'<tpl for="data">',"    <{parent.record}>\n",'<tpl for="parent.fields">',"        <{name}>{[parent[values.name]]}</{name}>\n","</tpl>","    </{parent.record}>\n","</tpl>","</{root}>"],doGet:function(E){var G=this,C=G.getData(E),D=G.getPage(E,C),B=E.xhr.options.operation.getProxy(),H=B&&B.getReader(),K=H&&H.getModel(),J=G.callParent(arguments),L={data:D,reader:H,fields:K&&K.fields,root:H&&H.getRootProperty(),record:H&&H.record},I,A,F;if(E.groupSpec){L.summaryData=G.getSummary(E,C,D)}if(G.xmlTpl){I=Ext.XTemplate.getTpl(G,"xmlTpl");A=I.apply(L)}else{A=C}if(typeof DOMParser!="undefined"){F=(new DOMParser()).parseFromString(A,"text/xml")}else{F=new ActiveXObject("Microsoft.XMLDOM");F.async=false;F.loadXML(A)}J.responseText=A;J.responseXML=F;return J},fixTree:function(){this.callParent(arguments);var A=[];this.buildTreeXml(this.data,A);this.data=A.join("")},buildTreeXml:function(D,B){var C=this.rootProperty,A=this.recordProperty;B.push("<",C,">");Ext.Array.forEach(D,function(F){B.push("<",A,">");for(var E in F){if(E=="children"){this.buildTreeXml(F.children,B)}else{B.push("<",E,">",F[E],"</",E,">")}}B.push("</",A,">")});B.push("</",C,">")}});Ext.define("Ext.ux.event.Driver",{extend:"Ext.util.Observable",active:null,specialKeysByName:{PGUP:33,PGDN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40},specialKeysByCode:{},getTextSelection:function(A){var F=A.ownerDocument,E,C,B,D;if(typeof A.selectionStart==="number"){B=A.selectionStart;D=A.selectionEnd}else{if(F.selection){E=F.selection.createRange();C=A.createTextRange();C.setEndPoint("EndToStart",E);B=C.text.length;D=B+E.text.length}}return[B,D]},getTime:function(){return new Date().getTime()},getTimestamp:function(){var A=this.getTime();return A-this.startTime},onStart:function(){},onStop:function(){},start:function(){var A=this;if(!A.active){A.active=new Date();A.startTime=A.getTime();A.onStart();A.fireEvent("start",A)}},stop:function(){var A=this;if(A.active){A.active=null;A.onStop();A.fireEvent("stop",A)}}},function(){var A=this.prototype;Ext.Object.each(A.specialKeysByName,function(B,C){A.specialKeysByCode[C]=B})});Ext.define("Ext.ux.event.Maker",{eventQueue:[],startAfter:500,timerIncrement:500,currentTiming:0,constructor:function(A){var B=this;B.currentTiming=B.startAfter;if(!Ext.isArray(A)){A=[A]}Ext.Array.each(A,function(C){C.el=C.el||"el";Ext.Array.each(Ext.ComponentQuery.query(C.cmpQuery),function(F){var E={},G,H,D;if(!C.domQuery){D=F[C.el]}else{D=F.el.down(C.domQuery)}E.target="#"+D.dom.id;E.type=C.type;E.button=A.button||0;G=D.getX()+(D.getWidth()/2);H=D.getY()+(D.getHeight()/2);E.xy=[G,H];E.ts=B.currentTiming;B.currentTiming+=B.timerIncrement;B.eventQueue.push(E)});if(C.screenshot){B.eventQueue[B.eventQueue.length-1].screenshot=true}});return B.eventQueue}});Ext.define("Ext.ux.event.Player",function(C){var B={},E={},A={},F,D={},H={resize:1,reset:1,submit:1,change:1,select:1,error:1,abort:1};Ext.each(["click","dblclick","mouseover","mouseout","mousedown","mouseup","mousemove"],function(I){H[I]=B[I]=E[I]={bubbles:true,cancelable:(I!="mousemove"),detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0}});Ext.each(["keydown","keyup","keypress"],function(I){H[I]=B[I]=A[I]={bubbles:true,cancelable:true,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:0,charCode:0}});Ext.each(["blur","change","focus","resize","scroll","select"],function(I){B[I]=D[I]={bubbles:(I in H),cancelable:false,detail:1}});var G={8:function(J,K,I){if(K<I){J.value=J.value.substring(0,K)+J.value.substring(I)}else{if(K>0){J.value=J.value.substring(0,--K)+J.value.substring(I)}}this.setTextSelection(J,K,K)},46:function(J,K,I){if(K<I){J.value=J.value.substring(0,K)+J.value.substring(I)}else{if(K<J.value.length-1){J.value=J.value.substring(0,K)+J.value.substring(K+1)}}this.setTextSelection(J,K,K)}};return{extend:"Ext.ux.event.Driver",keyFrameEvents:{click:true},pauseForAnimations:true,speed:1,stallTime:0,_inputSpecialKeys:{INPUT:G,TEXTAREA:Ext.apply({},G)},tagPathRegEx:/(\w+)(?:\[(\d+)\])?/,constructor:function(I){var J=this;J.callParent(arguments);J.timerFn=function(){J.onTick()};J.attachTo=J.attachTo||window;F=J.attachTo.document},getElementFromXPath:function(L){var R=this,P=L.split("/"),S=R.tagPathRegEx,N,O,Q,J,K,I,M=R.attachTo.document;M=(P[0]=="~")?M.body:M.getElementById(P[0].substring(1));for(N=1,O=P.length;M&&N<O;++N){Q=S.exec(P[N]);J=Q[2]?parseInt(Q[2],10):1;K=Q[1].toUpperCase();for(I=M.firstChild;I;I=I.nextSibling){if(I.tagName==K){if(J==1){break}--J}}M=I}return M},offsetToRangeCharacterMove:function(I,J){return J-(I.value.slice(0,J).split("\r\n").length-1)},setTextSelection:function(I,M,J){if(M<0){M+=I.value.length}if(J==null){J=M}if(J<0){J+=I.value.length}if(typeof I.selectionStart==="number"){I.selectionStart=M;I.selectionEnd=J}else{var K=I.createTextRange();var L=this.offsetToRangeCharacterMove(I,M);K.collapse(true);if(M==J){K.move("character",L)}else{K.moveEnd("character",this.offsetToRangeCharacterMove(I,J));K.moveStart("character",L)}K.select()}},getTimeIndex:function(){var I=this.getTimestamp()-this.stallTime;return I*this.speed},makeToken:function(I,L){var K=this,J;I[L]=true;I.defer=function(){I[L]=false;J=K.getTime()};I.finish=function(){I[L]=true;K.stallTime+=K.getTime()-J;K.schedule()}},nextEvent:function(I){var J=this,K=++J.queueIndex;if(J.keyFrameEvents[I.type]){Ext.Array.insert(J.eventQueue,K,[{keyframe:true,ts:I.ts}])}},peekEvent:function(){return this.eventQueue[this.queueIndex]||null},replaceEvent:function(L,J){for(var M,I=0,K=J.length;I<K;++I){if(I){M=J[I-1];delete M.afterplay;delete M.screenshot;delete J[I].beforeplay}}Ext.Array.replace(this.eventQueue,(L==null)?this.queueIndex:L,1,J)},processEvents:function(){var J=this,K=J.pauseForAnimations&&J.attachTo.Ext.fx.Manager.items,I;while((I=J.peekEvent())!==null){if(K&&K.getCount()){return true}if(I.keyframe){if(!J.processKeyFrame(I)){return false}J.nextEvent(I)}else{if(I.ts<=J.getTimeIndex()&&J.fireEvent("beforeplay",J,I)!==false&&J.playEvent(I)){J.nextEvent(I)}else{return true}}}J.stop();return false},processKeyFrame:function(I){var J=this;if(!I.defer){J.makeToken(I,"done");J.fireEvent("keyframe",J,I)}return I.done},injectEvent:function(N,L){var K=this,I=L.type,J=Ext.apply({},L,B[I]),M;if(I==="type"){M=K._inputSpecialKeys[N.tagName];if(M){return K.injectTypeInputEvent(N,L,M)}return K.injectTypeEvent(N,L)}if(I==="focus"&&N.focus){N.focus();return true}if(I==="blur"&&N.blur){N.blur();return true}if(I==="scroll"){N.scrollLeft=L.pos[0];N.scrollTop=L.pos[1];return true}if(I==="mduclick"){return K.injectEvent(N,Ext.applyIf({type:"mousedown"},L))&&K.injectEvent(N,Ext.applyIf({type:"mouseup"},L))&&K.injectEvent(N,Ext.applyIf({type:"click"},L))}if(E[I]){return C.injectMouseEvent(N,J,K.attachTo)}if(A[I]){return C.injectKeyEvent(N,J,K.attachTo)}if(D[I]){return C.injectUIEvent(N,I,J.bubbles,J.cancelable,J.view||K.attachTo,J.detail)}return false},injectTypeEvent:function(R,L){var K=this,Q=L.text,I=[],N,T,O,P,S,J,M;if(Q){delete L.text;J=Q.toUpperCase();for(O=0,P=Q.length;O<P;++O){N=Q.charCodeAt(O);T=J.charCodeAt(O);I.push(Ext.applyIf({type:"keydown",charCode:T,keyCode:T},L),Ext.applyIf({type:"keypress",charCode:N,keyCode:N},L),Ext.applyIf({type:"keyup",charCode:T,keyCode:T},L))}}else{I.push(Ext.applyIf({type:"keydown",charCode:L.keyCode},L),Ext.applyIf({type:"keyup",charCode:L.keyCode},L))}for(O=0,P=I.length;O<P;++O){K.injectEvent(R,I[O])}return true},injectTypeInputEvent:function(N,M,K){var L=this,I=M.text,O,J;if(K){O=L.getTextSelection(N);if(I){J=O[0];N.value=N.value.substring(0,J)+I+N.value.substring(O[1]);J+=I.length;L.setTextSelection(N,J,J)}else{if(!(K=K[M.keyCode])){if("caret" in M){L.setTextSelection(N,M.caret,M.caret)}else{if(M.selection){L.setTextSelection(N,M.selection[0],M.selection[1])}}return L.injectTypeEvent(N,M)}K.call(this,N,O[0],O[1]);return true}}return true},playEvent:function(I){var J=this,L=J.getElementFromXPath(I.target),K;if(!L){return false}if(!J.playEventHook(I,"beforeplay")){return false}if(!I.injected){I.injected=true;K=J.translateEvent(I,L);J.injectEvent(L,K)}return J.playEventHook(I,"afterplay")},playEventHook:function(J,M){var K=this,L=M+".done",N=M+".fired",I=J[M];if(I&&!J[L]){if(!J[N]){J[N]=true;K.makeToken(J,L);if(K.eventScope&&Ext.isString(I)){I=K.eventScope[I]}if(I){I.call(K.eventScope||K,J)}}return false}return true},schedule:function(){var I=this;if(!I.timer){I.timer=setTimeout(I.timerFn,10)}},_translateAcross:["type","button","charCode","keyCode","caret","pos","text","selection"],translateEvent:function(P,Q){var I=this,N={},L=P.modKeys||"",K=I._translateAcross,O=K.length,J,M;while(O--){J=K[O];if(J in P){N[J]=P[J]}}N.altKey=L.indexOf("A")>0;N.ctrlKey=L.indexOf("C")>0;N.metaKey=L.indexOf("M")>0;N.shiftKey=L.indexOf("S")>0;if(Q&&"x" in P){M=Ext.fly(Q).getXY();M[0]+=P.x;M[1]+=P.y}else{if("x" in P){M=[P.x,P.y]}else{if("px" in P){M=[P.px,P.py]}}}if(M){N.clientX=N.screenX=M[0];N.clientY=N.screenY=M[1]}if(P.key){N.keyCode=I.specialKeysByName[P.key]}if(P.type==="wheel"){if("onwheel" in I.attachTo.document){N.wheelX=P.dx;N.wheelY=P.dy}else{N.type="mousewheel";N.wheelDeltaX=-40*P.dx;N.wheelDeltaY=N.wheelDelta=-40*P.dy}}return N},onStart:function(){var I=this;I.queueIndex=0;I.schedule()},onStop:function(){var I=this;if(I.timer){clearTimeout(I.timer);I.timer=null}},onTick:function(){var I=this;I.timer=null;if(I.processEvents()){I.schedule()}},statics:{ieButtonCodeMap:{0:1,1:4,2:2},injectKeyEvent:function(O,M,I){var J=M.type,L=null;if(J==="textevent"){J="keypress"}I=I||window;if(F.createEvent){try{L=F.createEvent("KeyEvents");L.initKeyEvent(J,M.bubbles,M.cancelable,I,M.ctrlKey,M.altKey,M.shiftKey,M.metaKey,M.keyCode,M.charCode)}catch(K){try{L=F.createEvent("Events")}catch(N){L=F.createEvent("UIEvents")}finally{L.initEvent(J,M.bubbles,M.cancelable);L.view=I;L.altKey=M.altKey;L.ctrlKey=M.ctrlKey;L.shiftKey=M.shiftKey;L.metaKey=M.metaKey;L.keyCode=M.keyCode;L.charCode=M.charCode}}O.dispatchEvent(L)}else{if(F.createEventObject){L=F.createEventObject();L.bubbles=M.bubbles;L.cancelable=M.cancelable;L.view=I;L.ctrlKey=M.ctrlKey;L.altKey=M.altKey;L.shiftKey=M.shiftKey;L.metaKey=M.metaKey;L.keyCode=(M.charCode>0)?M.charCode:M.keyCode;O.fireEvent("on"+J,L)}else{return false}}return true},injectMouseEvent:function(M,L,I){var J=L.type,K=null;I=I||window;if(F.createEvent){K=F.createEvent("MouseEvents");if(K.initMouseEvent){K.initMouseEvent(J,L.bubbles,L.cancelable,I,L.detail,L.screenX,L.screenY,L.clientX,L.clientY,L.ctrlKey,L.altKey,L.shiftKey,L.metaKey,L.button,L.relatedTarget)}else{K=F.createEvent("UIEvents");K.initEvent(J,L.bubbles,L.cancelable);K.view=I;K.detail=L.detail;K.screenX=L.screenX;K.screenY=L.screenY;K.clientX=L.clientX;K.clientY=L.clientY;K.ctrlKey=L.ctrlKey;K.altKey=L.altKey;K.metaKey=L.metaKey;K.shiftKey=L.shiftKey;K.button=L.button;K.relatedTarget=L.relatedTarget}if(L.relatedTarget&&!K.relatedTarget){if(J=="mouseout"){K.toElement=L.relatedTarget}else{if(J=="mouseover"){K.fromElement=L.relatedTarget}}}M.dispatchEvent(K)}else{if(F.createEventObject){K=F.createEventObject();K.bubbles=L.bubbles;K.cancelable=L.cancelable;K.view=I;K.detail=L.detail;K.screenX=L.screenX;K.screenY=L.screenY;K.clientX=L.clientX;K.clientY=L.clientY;K.ctrlKey=L.ctrlKey;K.altKey=L.altKey;K.metaKey=L.metaKey;K.shiftKey=L.shiftKey;K.button=C.ieButtonCodeMap[L.button]||0;K.relatedTarget=L.relatedTarget;M.fireEvent("on"+J,K)}else{return false}}return true},injectUIEvent:function(L,K,I){var J=null;I=I||window;if(F.createEvent){J=F.createEvent("UIEvents");J.initUIEvent(K.type,K.bubbles,K.cancelable,I,K.detail);L.dispatchEvent(J)}else{if(F.createEventObject){J=F.createEventObject();J.bubbles=K.bubbles;J.cancelable=K.cancelable;J.view=I;J.detail=K.detail;L.fireEvent("on"+K.type,J)}else{return false}}return true}}}});Ext.define("Ext.ux.event.Recorder",function(E){function B(){var I=arguments,G=I.length,H={kind:"other"},F;for(F=0;F<G;++F){Ext.apply(H,arguments[F])}if(H.alt&&!H.event){H.event=H.alt}return H}function A(F){return B({kind:"keyboard",modKeys:true,key:true},F)}function C(F){return B({kind:"mouse",button:true,modKeys:true,xy:true},F)}var D={keydown:A(),keypress:A(),keyup:A(),dragmove:C({alt:"mousemove",pageCoords:true,whileDrag:true}),mousemove:C({pageCoords:true}),mouseover:C(),mouseout:C(),click:C(),wheel:C({wheel:true}),mousedown:C({press:true}),mouseup:C({release:true}),scroll:B({listen:false}),focus:B(),blur:B()};for(var A in D){if(!D[A].event){D[A].event=A}}D.wheel.event=null;return{extend:"Ext.ux.event.Driver",eventsToRecord:D,ignoreIdRegEx:/ext-gen(?:\d+)/,inputRe:/^(input|textarea)$/i,constructor:function(F){var G=this,H=F&&F.eventsToRecord;if(H){G.eventsToRecord=Ext.apply(Ext.apply({},G.eventsToRecord),H);delete F.eventsToRecord}G.callParent(arguments);G.clear();G.modKeys=[];G.attachTo=G.attachTo||window},clear:function(){this.eventsRecorded=[]},listenToEvent:function(I){var H=this,F=H.attachTo.document.body,G=function(){return H.onEvent.apply(H,arguments)},J={};if(F.attachEvent&&F.ownerDocument.documentMode<10){I="on"+I;F.attachEvent(I,G);J.destroy=function(){if(G){F.detachEvent(I,G);G=null}}}else{F.addEventListener(I,G,true);J.destroy=function(){if(G){F.removeEventListener(I,G,true);G=null}}}return J},coalesce:function(F,G){var J=this,K=J.eventsRecorded,H=K.length,I=H&&K[H-1],M=(H>1)&&K[H-2],L=(H>2)&&K[H-3];if(!I){return false}if(F.type==="mousemove"){if(I.type==="mousemove"&&F.ts-I.ts<200){F.ts=I.ts;K[H-1]=F;return true}}else{if(F.type==="click"){if(M&&I.type==="mouseup"&&M.type==="mousedown"){if(F.button==I.button&&F.button==M.button&&F.target==I.target&&F.target==M.target&&J.samePt(F,I)&&J.samePt(F,M)){K.pop();M.type="mduclick";return true}}}else{if(F.type==="keyup"){if(M&&I.type==="keypress"&&M.type==="keydown"){if(F.target===I.target&&F.target===M.target){K.pop();M.type="type";M.text=String.fromCharCode(I.charCode);delete M.charCode;delete M.keyCode;if(L&&L.type==="type"){if(L.text&&L.target===M.target){L.text+=M.text;K.pop()}}return true}}else{if(J.completeKeyStroke(I,F)){I.type="type";J.completeSpecialKeyStroke(G.target,I,F);return true}else{if(I.type==="scroll"&&J.completeKeyStroke(M,F)){M.type="type";J.completeSpecialKeyStroke(G.target,M,F);K.pop();K.pop();K.push(I,M);return true}}}}}}return false},completeKeyStroke:function(F,G){if(F&&F.type==="keydown"&&F.keyCode===G.keyCode){delete F.charCode;return true}return false},completeSpecialKeyStroke:function(H,F,I){var G=this.specialKeysByCode[I.keyCode];if(G&&this.inputRe.test(H.tagName)){delete F.keyCode;F.key=G;F.selection=this.getTextSelection(H);if(F.selection[0]===F.selection[1]){F.caret=F.selection[0];delete F.selection}return true}return false},getElementXPath:function(I){var L=this,M=false,J=[],F,K,H,G;for(H=I;H;H=H.parentNode){if(H==L.attachTo.document.body){J.unshift("~");M=true;break}if(H.id&&!L.ignoreIdRegEx.test(H.id)){J.unshift("#"+H.id);M=true;break}for(F=1,K=H;!!(K=K.previousSibling);){if(K.tagName==H.tagName){++F}}G=H.tagName.toLowerCase();if(F<2){J.unshift(G)}else{J.unshift(G+"["+F+"]")}}return M?J.join("/"):null},getRecordedEvents:function(){return this.eventsRecorded},onEvent:function(I){var F=this,H=new Ext.event.Event(I),N=F.eventsToRecord[H.type],M,J,K,G={type:H.type,ts:F.getTimestamp(),target:F.getElementXPath(H.target)},L;if(!N||!G.target){return}M=H.target.ownerDocument;M=M.defaultView||M.parentWindow;if(M!==F.attachTo){return}if(F.eventsToRecord.scroll){F.syncScroll(H.target)}if(N.xy){L=H.getXY();if(N.pageCoords||!G.target){G.px=L[0];G.py=L[1]}else{K=Ext.fly(H.getTarget()).getXY();L[0]-=K[0];L[1]-=K[1];G.x=L[0];G.y=L[1]}}if(N.button){if("buttons" in I){G.button=I.buttons}else{G.button=I.button}if(!G.button&&N.whileDrag){return}}if(N.wheel){G.type="wheel";if(N.event==="wheel"){G.dx=I.deltaX;G.dy=I.deltaY}else{if(typeof I.wheelDeltaX==="number"){G.dx=-1/40*I.wheelDeltaX;G.dy=-1/40*I.wheelDeltaY}else{if(I.wheelDelta){G.dy=-1/40*I.wheelDelta}else{if(I.detail){G.dy=I.detail}}}}}if(N.modKeys){F.modKeys[0]=H.altKey?"A":"";F.modKeys[1]=H.ctrlKey?"C":"";F.modKeys[2]=H.metaKey?"M":"";F.modKeys[3]=H.shiftKey?"S":"";J=F.modKeys.join("");if(J){G.modKeys=J}}if(N.key){G.charCode=H.getCharCode();G.keyCode=H.getKey()}if(F.coalesce(G,H)){F.fireEvent("coalesce",F,G)}else{F.eventsRecorded.push(G);F.fireEvent("add",F,G)}},onStart:function(){var H=this,G=H.attachTo.Ext.dd.DragDropManager,F=H.attachTo.Ext.EventObjectImpl.prototype,I=[];E.prototype.eventsToRecord.wheel.event=("onwheel" in H.attachTo.document)?"wheel":"mousewheel";H.listeners=[];Ext.Object.each(H.eventsToRecord,function(J,K){if(K&&K.listen!==false){if(!K.event){K.event=J}if(K.alt&&K.alt!==J){if(!H.eventsToRecord[K.alt]){I.push(K)}}else{H.listeners.push(H.listenToEvent(K.event))}}});Ext.each(I,function(J){H.eventsToRecord[J.alt]=J;H.listeners.push(H.listenToEvent(J.alt))});H.ddmStopEvent=G.stopEvent;G.stopEvent=Ext.Function.createSequence(G.stopEvent,function(J){H.onEvent(J)});H.evStopEvent=F.stopEvent;F.stopEvent=Ext.Function.createSequence(F.stopEvent,function(){H.onEvent(this)})},onStop:function(){var F=this;Ext.destroy(F.listeners);F.listeners=null;F.attachTo.Ext.dd.DragDropManager.stopEvent=F.ddmStopEvent;F.attachTo.Ext.EventObjectImpl.prototype.stopEvent=F.evStopEvent},samePt:function(F,G){return F.x==G.x&&F.y==G.y},syncScroll:function(J){var L=this,K=L.getTimestamp(),F,O,M,N,I,H;for(var G=J;G;G=G.parentNode){F=G.$lastScrollLeft;O=G.$lastScrollTop;M=G.scrollLeft;N=G.scrollTop;I=false;if(F!==M){if(M){I=true}G.$lastScrollLeft=M}if(O!==N){if(N){I=true}G.$lastScrollTop=N}if(I){L.eventsRecorded.push(H={type:"scroll",target:L.getElementXPath(G),ts:K,pos:[M,N]});L.fireEvent("add",L,H)}if(G.tagName==="BODY"){break}}}}});Ext.define("Ext.ux.BoxReorderer",{requires:["Ext.dd.DD"],mixins:{observable:"Ext.util.Observable"},itemSelector:".x-box-item",animate:100,constructor:function(){this.mixins.observable.constructor.apply(this,arguments)},init:function(B){var A=this;A.container=B;A.animatePolicy={};A.animatePolicy[B.getLayout().names.x]=true;A.container.on({scope:A,boxready:A.onBoxReady,beforedestroy:A.onContainerDestroy})},onContainerDestroy:function(){var A=this.dd;if(A){A.unreg();this.dd=null}},onBoxReady:function(){var A=this,B=A.container.getLayout(),C=B.names,D;D=A.dd=new Ext.dd.DD(B.innerCt,A.container.id+"-reorderer");Ext.apply(D,{animate:A.animate,reorderer:A,container:A.container,getDragCmp:A.getDragCmp,clickValidator:Ext.Function.createInterceptor(D.clickValidator,A.clickValidator,A,false),onMouseDown:A.onMouseDown,startDrag:A.startDrag,onDrag:A.onDrag,endDrag:A.endDrag,getNewIndex:A.getNewIndex,doSwap:A.doSwap,findReorderable:A.findReorderable});D.dim=C.width;D.startAttr=C.beforeX;D.endAttr=C.afterX},getDragCmp:function(A){return this.container.getChildByElement(A.getTarget(this.itemSelector,10))},clickValidator:function(A){var B=this.getDragCmp(A);return !!(B&&B.reorderable!==false)},onMouseDown:function(B){var C=this,F=C.container,A,D,E;C.dragCmp=C.getDragCmp(B);if(C.dragCmp){D=C.dragCmp.getEl();C.startIndex=C.curIndex=F.items.indexOf(C.dragCmp);E=D.getBox();C.lastPos=E[C.startAttr];A=F.el.getBox();if(C.dim==="width"){C.minX=A.left;C.maxX=A.right-E.width;C.minY=C.maxY=E.top;C.deltaX=B.getX()-E.left}else{C.minY=A.top;C.maxY=A.bottom-E.height;C.minX=C.maxX=E.left;C.deltaY=B.getY()-E.top}C.constrainY=C.constrainX=true}},startDrag:function(){var A=this,B=A.dragCmp;if(B){B.setPosition=Ext.emptyFn;B.animate=false;if(A.animate){A.container.getLayout().animatePolicy=A.reorderer.animatePolicy}A.dragElId=B.getEl().id;A.reorderer.fireEvent("StartDrag",A,A.container,B,A.curIndex);B.suspendEvents();B.disabled=true;B.el.setStyle("zIndex",100)}else{A.dragElId=null}},findReorderable:function(D){var B=this,C=B.container.items,A;if(C.getAt(D).reorderable===false){A=C.getAt(D);if(D>B.startIndex){while(A&&A.reorderable===false){D++;A=C.getAt(D)}}else{while(A&&A.reorderable===false){D--;A=C.getAt(D)}}}D=Math.min(Math.max(D,0),C.getCount()-1);if(C.getAt(D).reorderable===false){return -1}return D},doSwap:function(A){var E=this,F=E.container.items,D=E.container,C=E.container._isLayoutRoot,H,B,G;A=E.findReorderable(A);if(A===-1){return}E.reorderer.fireEvent("ChangeIndex",E,D,E.dragCmp,E.startIndex,A);H=F.getAt(E.curIndex);B=F.getAt(A);F.remove(H);G=Math.min(Math.max(A,0),F.getCount()-1);F.insert(G,H);F.remove(B);F.insert(E.curIndex,B);D._isLayoutRoot=true;D.updateLayout();D._isLayoutRoot=C;E.curIndex=A},onDrag:function(A){var B=this,C;C=B.getNewIndex(A.getPoint());if((C!==undefined)){B.reorderer.fireEvent("Drag",B,B.container,B.dragCmp,B.startIndex,B.curIndex);B.doSwap(C)}},endDrag:function(A){if(A){A.stopEvent()}var B=this,C=B.container.getLayout(),D;if(B.dragCmp){delete B.dragElId;delete B.dragCmp.setPosition;B.dragCmp.animate=true;B.dragCmp.lastBox[C.names.x]=B.dragCmp.getPosition(true)[C.names.widthIndex];B.container._isLayoutRoot=true;B.container.updateLayout();B.container._isLayoutRoot=undefined;D=Ext.fx.Manager.getFxQueue(B.dragCmp.el.id)[0];if(D){D.on({afteranimate:B.reorderer.afterBoxReflow,scope:B})}else{Ext.Function.defer(B.reorderer.afterBoxReflow,1,B)}if(B.animate){delete C.animatePolicy}B.reorderer.fireEvent("drop",B,B.container,B.dragCmp,B.startIndex,B.curIndex)}},afterBoxReflow:function(){var A=this;A.dragCmp.el.setStyle("zIndex","");A.dragCmp.disabled=false;A.dragCmp.resumeEvents()},getNewIndex:function(G){var I=this,E=I.getDragEl(),H=Ext.fly(E).getBox(),K,A,J,F=0,B=I.container.items.items,C=B.length,D=I.lastPos;I.lastPos=H[I.startAttr];for(;F<C;F++){K=B[F].getEl();if(K.is(I.reorderer.itemSelector)){A=K.getBox();J=A[I.startAttr]+(A[I.dim]>>1);if(F<I.curIndex){if((H[I.startAttr]<D)&&(H[I.startAttr]<(J-5))){return F}}else{if(F>I.curIndex){if((H[I.startAttr]>D)&&(H[I.endAttr]>(J+5))){return F}}}}}}});Ext.define("Ext.ux.CellDragDrop",{extend:"Ext.plugin.Abstract",alias:"plugin.celldragdrop",uses:["Ext.view.DragZone"],enforceType:false,applyEmptyText:false,emptyText:"",dropBackgroundColor:"green",noDropBackgroundColor:"red",dragText:"{0} selected row{1}",ddGroup:"GridDD",enableDrop:true,enableDrag:true,containerScroll:false,init:function(B){var A=this;B.on("render",A.onViewRender,A,{single:true})},destroy:function(){var A=this;A.dragZone=A.dropZone=Ext.destroy(A.dragZone,A.dropZone);A.callParent()},enable:function(){var A=this;if(A.dragZone){A.dragZone.unlock()}if(A.dropZone){A.dropZone.unlock()}A.callParent()},disable:function(){var A=this;if(A.dragZone){A.dragZone.lock()}if(A.dropZone){A.dropZone.lock()}A.callParent()},onViewRender:function(B){var A=this,C;if(A.enableDrag){if(A.containerScroll){C=B.getEl()}A.dragZone=new Ext.view.DragZone({view:B,ddGroup:A.dragGroup||A.ddGroup,dragText:A.dragText,containerScroll:A.containerScroll,scrollEl:C,getDragData:function(E){var G=this.view,F=E.getTarget(G.getItemSelector()),I=G.getRecord(F),H=E.getTarget(G.getCellSelector()),J,D;if(F){J=document.createElement("div");J.className="x-form-text";J.appendChild(document.createTextNode(H.textContent||H.innerText));D=G.getHeaderByCell(H);return{event:new Ext.EventObjectImpl(E),ddel:J,item:E.target,columnName:D.dataIndex,record:I}}},onInitDrag:function(I,K){var F=this,G=F.dragData,D=F.view,H=D.getSelectionModel(),J=G.record,E=G.ddel;if(!H.isSelected(J)){H.select(J,true)}Ext.fly(F.ddel).update(E.textContent||E.innerText);F.proxy.update(F.ddel);F.onStartDrag(I,K);return true}})}if(A.enableDrop){A.dropZone=new Ext.dd.DropZone(B.el,{view:B,ddGroup:A.dropGroup||A.ddGroup,containerScroll:true,getTargetFromEvent:function(E){var I=this,G=I.view,H=E.getTarget(G.cellSelector),F,D;if(H){F=G.findItemByChild(H);D=G.getHeaderByCell(H);if(F&&D){return{node:H,record:G.getRecord(F),columnName:D.dataIndex}}}},onNodeEnter:function(I,J,F,E){var G=this,H=I.record.getField(I.columnName).type.toUpperCase(),D=E.record.getField(E.columnName).type.toUpperCase();delete G.dropOK;if(!I||I.node===E.item.parentNode){return}if(A.enforceType&&H!==D){G.dropOK=false;if(A.noDropCls){Ext.fly(I.node).addCls(A.noDropCls)}else{Ext.fly(I.node).applyStyles({backgroundColor:A.noDropBackgroundColor})}return false}G.dropOK=true;if(A.dropCls){Ext.fly(I.node).addCls(A.dropCls)}else{Ext.fly(I.node).applyStyles({backgroundColor:A.dropBackgroundColor})}},onNodeOver:function(F,G,E,D){return this.dropOK?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(G,H,E,D){var F=this.dropOK?A.dropCls:A.noDropCls;if(F){Ext.fly(G.node).removeCls(F)}else{Ext.fly(G.node).applyStyles({backgroundColor:""})}},onNodeDrop:function(F,G,E,D){if(this.dropOK){F.record.set(F.columnName,D.record.get(D.columnName));if(A.applyEmptyText){D.record.set(D.columnName,A.emptyText)}return true}},onCellDrop:Ext.emptyFn})}}});Ext.define("Ext.ux.DataTip",function(C){function E(){var F=this.isXType("panel")?this.body:this.el;if(this.dataTip.renderToTarget){this.dataTip.render(F)}this.dataTip.setTarget(F)}function D(F,G){if(F.rendered){if(F.host.fireEvent("beforeshowtip",F.eventHost,F,G)===false){return false}F.update(G)}else{if(Ext.isString(G)){F.html=G}else{F.data=G}}}function B(G){var F=this.view.getRecord(G.triggerElement),H;if(F){H=G.initialConfig.data?Ext.apply(G.initialConfig.data,F.data):F.data;return D(G,H)}else{return false}}function A(F){var G=Ext.getCmp(F.triggerElement.id);if(G&&(G.tooltip||F.tpl)){return D(F,G.tooltip||G)}else{return false}}return{extend:"Ext.tip.ToolTip",mixins:{plugin:"Ext.plugin.Abstract"},alias:"plugin.datatip",lockableScope:"both",constructor:function(F){var G=this;G.callParent([F]);G.mixins.plugin.constructor.call(G,F)},init:function(F){var G=this;G.mixins.plugin.init.call(G,F);F.dataTip=G;G.host=F;if(F.isXType("tablepanel")){G.view=F.getView();if(F.ownerLockable){G.host=F.ownerLockable}G.delegate=G.delegate||G.view.rowSelector;G.on("beforeshow",B)}else{if(F.isXType("dataview")){G.view=G.host;G.delegate=G.delegate||F.itemSelector;G.on("beforeshow",B)}else{if(F.isXType("form")){G.delegate="."+Ext.form.Labelable.prototype.formItemCls;G.on("beforeshow",A)}else{if(F.isXType("combobox")){G.view=F.getPicker();G.delegate=G.delegate||G.view.getItemSelector();G.on("beforeshow",B)}}}}if(F.rendered){E.call(F)}else{F.onRender=Ext.Function.createSequence(F.onRender,E)}}}});Ext.ux.DataViewTransition=Ext.extend(Object,{defaults:{duration:750,idProperty:"id"},constructor:function(A){Ext.apply(this,A||{},this.defaults)},init:function(A){this.dataview=A;var B=this.idProperty;A.blockRefresh=true;A.updateIndexes=Ext.Function.createSequence(A.updateIndexes,function(){this.getTargetEl().select(this.itemSelector).each(function(E,C,D){E.id=E.dom.id=Ext.util.Format.format("{0}-{1}",A.id,A.store.getAt(D).get(B))},this)},A);this.dataviewID=A.id;this.cachedStoreData={};this.cacheStoreData(A.store.snapshot);A.store.on("datachanged",function(K){var X=A.getTargetEl(),T=K.getAt(0),M=this.getAdded(K),U=this.getRemoved(K),Z=this.getRemaining(K),W=Ext.apply({},Z,M);Ext.each(U,function(c){Ext.fly(this.dataviewID+"-"+c.get(this.idProperty)).animate({remove:false,duration:J,opacity:0,useDisplay:true})},this);if(T==undefined){this.cacheStoreData(K);return}var b=Ext.get(this.dataviewID+"-"+T.get(this.idProperty));var L=K.getCount(),D=b.getMargin("lr")+b.getWidth(),E=b.getMargin("bt")+b.getHeight(),R=X.getWidth(),Q=Math.floor(R/D),a=Math.ceil(L/Q),P=Math.ceil(this.getExistingCount()/Q);X.applyStyles({display:"block",position:"relative"});var G={},O={},S={};Ext.iterate(Z,function(e,d){var e=d.get(this.idProperty),c=S[e]=Ext.get(this.dataviewID+"-"+e);G[e]={top:c.getY()-X.getY()-c.getMargin("t")-X.getPadding("t"),left:c.getX()-X.getX()-c.getMargin("l")-X.getPadding("l")}},this);Ext.iterate(Z,function(f,d){var e=G[f],c=S[f];if(c.getStyle("position")!="absolute"){S[f].applyStyles({position:"absolute",left:e.left+"px",top:e.top+"px",width:c.getWidth(!Ext.isIE||Ext.isStrict),height:c.getHeight(!Ext.isIE||Ext.isStrict)})}});var Y=0;Ext.iterate(K.data.items,function(g){var i=g.get(B),c=S[i];var h=Y%Q,f=Math.floor(Y/Q),e=f*E,d=h*D;O[i]={top:e,left:d};Y++},this);var N=new Date(),J=this.duration,H=this.dataviewID;var C=function(){var m=new Date()-N,g=m/J;if(g>=1){for(var l in O){Ext.fly(H+"-"+l).applyStyles({top:O[l].top+"px",left:O[l].left+"px"})}Ext.TaskManager.stop(I)}else{for(var l in O){if(!Z[l]){continue}var f=G[l],e=O[l],h=f.top,o=e.top,i=f.left,n=e.left,c=g*Math.abs(h-o),k=g*Math.abs(i-n),j=h>o?h-c:h+c,d=i>n?i-k:i+k;Ext.fly(H+"-"+l).applyStyles({top:j+"px",left:d+"px"})}}};var I={run:C,interval:20,scope:this};Ext.TaskManager.start(I);var V=0;for(var F in M){V++}if(Ext.global.console&&Ext.global.console.log){Ext.global.console.log("added:",V)}Ext.iterate(M,function(d,c){Ext.fly(this.dataviewID+"-"+c.get(this.idProperty)).applyStyles({top:O[c.get(this.idProperty)].top+"px",left:O[c.get(this.idProperty)].left+"px"});Ext.fly(this.dataviewID+"-"+c.get(this.idProperty)).animate({remove:false,duration:J,opacity:1})},this);this.cacheStoreData(K)},this)},cacheStoreData:function(A){this.cachedStoreData={};A.each(function(B){this.cachedStoreData[B.get(this.idProperty)]=B},this)},getExisting:function(){return this.cachedStoreData},getExistingCount:function(){var A=0,B=this.getExisting();for(var C in B){A++}return A},getAdded:function(A){var B={};A.each(function(C){if(this.cachedStoreData[C.get(this.idProperty)]==undefined){B[C.get(this.idProperty)]=C}},this);return B},getRemoved:function(A){var B=[];for(var C in this.cachedStoreData){if(A.findExact(this.idProperty,Number(C))==-1){B.push(this.cachedStoreData[C])}}return B},getRemaining:function(B){var A={};B.each(function(C){if(this.cachedStoreData[C.get(this.idProperty)]!=undefined){A[C.get(this.idProperty)]=C}},this);return A}});Ext.define("Ext.ux.DataView.Animated",{defaults:{duration:750,idProperty:"id"},constructor:function(A){Ext.apply(this,A||{},this.defaults)},init:function(D){var C=this,A=D.store,E=D.all,F={interval:20},G=C.duration;C.dataview=D;D.blockRefresh=true;D.updateIndexes=Ext.Function.createSequence(D.updateIndexes,function(){this.getTargetEl().select(this.itemSelector).each(function(J,H,I){J.dom.id=Ext.util.Format.format("{0}-{1}",D.id,A.getAt(I).internalId)},this)},D);C.dataviewID=D.id;C.cachedStoreData={};C.cacheStoreData(A.data||A.snapshot);D.on("resize",function(){var H=D.store;if(H.getCount()>0){}},this);D.store.on({datachanged:B,scope:this,buffer:50});function B(){var U=D.getTargetEl(),X=U.getY(),I=U.getPadding("t"),O=C.getAdded(A),T=C.getRemoved(A),W=C.getRemaining(A),R,M,V,J=new Ext.dom.Fly(),K=C.dataview.getInherited().rtl,P,H,Y=K?"right":"left",N={};if(!U){return}Ext.iterate(T,function(Z,a){V=C.dataviewID+"-"+Z;Ext.fx.Manager.stopAnimation(V);a.dom=Ext.getDom(V);if(!a.dom){delete T[Z]}});C.cacheStoreData(A);var L={},Q={};Ext.iterate(W,function(a,Z){if(J.attach(Ext.getDom(C.dataviewID+"-"+a))){P=L[a]={top:J.getY()-X-J.getMargin("t")-I};P[Y]=C.getItemX(J)}else{delete W[a]}});D.refresh();Ext.iterate(T,function(a,Z){U.dom.appendChild(Z.dom);J.attach(Z.dom).animate({duration:G,opacity:0,callback:function(c){var b=Ext.get(c.target.id);if(b){b.destroy()}}});delete Z.dom});if(!A.getCount()){return}R=E.slice();for(M=R.length-1;M>=0;M--){V=A.getAt(M).internalId;J.attach(R[M]);Q[V]={dom:J.dom,top:J.getY()-X-J.getMargin("t")-I};Q[V][Y]=C.getItemX(J);H=L[V]||Q[V];N.position="absolute";N.top=H.top+"px";N[Y]=H.left+"px";J.applyStyles(N)}var S=function(){var i=new Date()-F.taskStartTime,d=i/G;if(d>=1){N.position=N.top=N[Y]="";for(V in Q){J.attach(Q[V].dom).applyStyles(N)}Ext.TaskManager.stop(F)}else{for(V in W){var c=L[V],e=Q[V],b=c.top,k=e.top,f=c[Y],j=e[Y],Z=d*Math.abs(b-k),h=d*Math.abs(f-j),g=b>k?b-Z:b+Z,a=f>j?f-h:f+h;N.top=g+"px";N[Y]=a+"px";J.attach(e.dom).applyStyles(N)}}};Ext.iterate(O,function(a,Z){if(J.attach(Ext.getDom(C.dataviewID+"-"+a))){J.setOpacity(0);J.animate({duration:G,opacity:1})}});Ext.TaskManager.stop(F);F.run=S;Ext.TaskManager.start(F);C.cacheStoreData(A)}},getItemX:function(A){var B=this.dataview.getInherited().rtl,C=A.up("");if(B){return C.getViewRegion().right-A.getRegion().right+A.getMargin("r")}else{return A.getX()-C.getX()-A.getMargin("l")-C.getPadding("l")}},cacheStoreData:function(A){var B=this.cachedStoreData={};A.each(function(C){B[C.internalId]=C})},getExisting:function(){return this.cachedStoreData},getExistingCount:function(){var A=0,B=this.getExisting();for(var C in B){A++}return A},getAdded:function(A){var B=this.cachedStoreData,C={};A.each(function(D){if(B[D.internalId]==null){C[D.internalId]=D}});return C},getRemoved:function(A){var B=this.cachedStoreData,C={},D;for(D in B){if(A.findBy(function(E){return E.internalId==D})==-1){C[D]=B[D]}}return C},getRemaining:function(B){var C=this.cachedStoreData,A={};B.each(function(D){if(C[D.internalId]!=null){A[D.internalId]=D}});return A}});Ext.define("Ext.ux.DataView.DragSelector",{requires:["Ext.dd.DragTracker","Ext.util.Region"],init:function(A){this.dataview=A;A.mon(A,{beforecontainerclick:this.cancelClick,scope:this,render:{fn:this.onRender,scope:this,single:true}})},onRender:function(){this.tracker=Ext.create("Ext.dd.DragTracker",{dataview:this.dataview,el:this.dataview.el,dragSelector:this,onBeforeStart:this.onBeforeStart,onStart:this.onStart,onDrag:this.onDrag,onEnd:this.onEnd});this.dragRegion=Ext.create("Ext.util.Region")},onBeforeStart:function(A){return A.target==this.dataview.getEl().dom},onStart:function(A){var B=this.dragSelector,C=this.dataview;this.dragging=true;B.fillRegions();B.getProxy().show();C.getSelectionModel().deselectAll()},cancelClick:function(){return !this.tracker.dragging},onDrag:function(N){var E=this.dragSelector,G=E.dataview.getSelectionModel(),F=E.dragRegion,D=E.bodyRegion,K=E.getProxy(),C=E.regions,A=C.length,J=this.startXY,M=this.getXY(),B=Math.min(J[0],M[0]),L=Math.min(J[1],M[1]),Q=Math.abs(J[0]-M[0]),P=Math.abs(J[1]-M[1]),H,I,O;Ext.apply(F,{top:L,left:B,right:B+Q,bottom:L+P});F.constrainTo(D);K.setBox(F);for(O=0;O<A;O++){H=C[O];I=F.intersect(H);if(I){G.select(O,true)}else{G.deselect(O)}}},onEnd:Ext.Function.createDelayed(function(A){var C=this.dataview,D=C.getSelectionModel(),B=this.dragSelector;this.dragging=false;B.getProxy().hide()},1),getProxy:function(){if(!this.proxy){this.proxy=this.dataview.getEl().createChild({tag:"div",cls:"x-view-selector"})}return this.proxy},fillRegions:function(){var B=this.dataview,A=this.regions=[];B.all.each(function(C){A.push(C.getRegion())});this.bodyRegion=B.getEl().getRegion()}});Ext.define("Ext.ux.DataView.Draggable",{requires:"Ext.dd.DragZone",ghostCls:"x-dataview-draggable-ghost",ghostTpl:['<tpl for=".">',"{title}","</tpl>"],init:function(B,A){this.dataview=B;B.on("render",this.onRender,this);Ext.apply(this,{itemSelector:B.itemSelector,ghostConfig:{}},A||{});Ext.applyIf(this.ghostConfig,{itemSelector:"img",cls:this.ghostCls,tpl:this.ghostTpl})},onRender:function(){var A=Ext.apply({},this.ddConfig||{},{dvDraggable:this,dataview:this.dataview,getDragData:this.getDragData,getTreeNode:this.getTreeNode,afterRepair:this.afterRepair,getRepairXY:this.getRepairXY});this.dragZone=Ext.create("Ext.dd.DragZone",this.dataview.getEl(),A)},getDragData:function(C){var B=this.dvDraggable,E=this.dataview,G=E.getSelectionModel(),F=C.getTarget(B.itemSelector),D,A;if(F){if(!E.isSelected(F)){G.select(E.getRecord(F))}D=E.getSelectedNodes();A={copy:true,nodes:D,records:G.getSelection(),item:true};if(D.length===1){A.single=true;A.ddel=F}else{A.multi=true;A.ddel=B.prepareGhost(G.getSelection())}return A}return false},getTreeNode:function(){},afterRepair:function(){this.dragging=false;var C=this.dragData.nodes,A=C.length,B;for(B=0;B<A;B++){Ext.get(C[B]).frame("#8db2e3",1)}},getRepairXY:function(A){if(this.dragData.multi){return false}else{var C=Ext.get(this.dragData.ddel),B=C.getXY();B[0]+=C.getPadding("t")+C.getMargin("t");B[1]+=C.getPadding("l")+C.getMargin("l");return B}},prepareGhost:function(A){return this.createGhost(A).getEl().dom},createGhost:function(B){var C=this,A;if(C.ghost){(A=C.ghost.store).loadRecords(B)}else{A=Ext.create("Ext.data.Store",{model:B[0].self});A.loadRecords(B);C.ghost=Ext.create("Ext.view.View",Ext.apply({renderTo:document.createElement("div"),store:A},C.ghostConfig));C.ghost.container.skipGarbageCollection=C.ghost.el.skipGarbageCollection=true}A.clearData();return C.ghost},destroy:function(){var A=this.ghost;if(A){A.container.destroy();A.destroy()}this.callParent()}});Ext.define("Ext.ux.DataView.LabelEditor",{extend:"Ext.Editor",alignment:"tl-tl",completeOnEnter:true,cancelOnEsc:true,shim:false,autoSize:{width:"boundEl",height:"field"},labelSelector:"x-editable",requires:["Ext.form.field.Text"],constructor:function(A){A.field=A.field||Ext.create("Ext.form.field.Text",{allowOnlyWhitespace:false,selectOnFocus:true});this.callParent([A])},init:function(A){this.view=A;this.mon(A,"afterrender",this.bindEvents,this);this.on("complete",this.onSave,this)},bindEvents:function(){this.mon(this.view.getEl(),{click:{fn:this.onClick,scope:this}})},onClick:function(B,E){var D=this,C,A;if(Ext.fly(E).hasCls(D.labelSelector)&&!D.editing&&!B.ctrlKey&&!B.shiftKey){B.stopEvent();C=D.view.findItemByChild(E);A=D.view.store.getAt(D.view.indexOf(C));D.startEdit(E,A.data[D.dataIndex]);D.activeRecord=A}else{if(D.editing){D.field.blur();B.preventDefault()}}},onSave:function(A,B){this.activeRecord.set(this.dataIndex,B)}});Ext.define("Ext.ux.Explorer",{extend:"Ext.panel.Panel",xtype:"explorer",requires:["Ext.layout.container.Border","Ext.toolbar.Breadcrumb","Ext.tree.Panel"],config:{breadcrumb:{dock:"top",xtype:"breadcrumb",reference:"breadcrumb"},contentView:{xtype:"dataview",reference:"contentView",region:"center",cls:Ext.baseCSSPrefix+"explorer-view",itemSelector:"."+Ext.baseCSSPrefix+"explorer-item",tpl:'<tpl for="."><div class="'+Ext.baseCSSPrefix+'explorer-item"><div class="{iconCls}"><div class="'+Ext.baseCSSPrefix+'explorer-node-icon{[values.leaf ? " '+Ext.baseCSSPrefix+'explorer-leaf-icon" : ""]}"></div><div class="'+Ext.baseCSSPrefix+'explorer-item-text">{text}</div></div></div></tpl>'},store:null,tree:{xtype:"treepanel",reference:"tree",region:"west",width:200}},renderConfig:{selection:null},layout:"border",referenceHolder:true,defaultListenerScope:true,cls:Ext.baseCSSPrefix+"explorer",initComponent:function(){var B=this,A=B.getStore();if(!A){Ext.raise("Ext.ux.Explorer requires a store.")}B.dockedItems=[B.getBreadcrumb()];B.items=[B.getTree(),B.getContentView()];B.callParent()},applyBreadcrumb:function(A){var B=this.getStore();A=Ext.create(Ext.apply({store:B,selection:B.getRoot()},A));A.on("selectionchange","_onBreadcrumbSelectionChange",this);return A},applyContentView:function(A){var B=this.contentStore=new Ext.data.Store({model:this.getStore().model});A=Ext.create(Ext.apply({store:B},A));return A},applyTree:function(A){A=Ext.create(Ext.apply({store:this.getStore()},A));A.on("selectionchange","_onTreeSelectionChange",this);return A},updateSelection:function(G){var H=this,A=H.getReferences(),D=A.breadcrumb,I=A.tree,B=I.getSelectionModel(),C=H.contentStore,E,F;if(D.getSelection()!==G){D.setSelection(G)}if(B.getSelection()[0]!==G){B.select([G]);E=G.parentNode;if(E){E.expand()}F=I.getView();F.scrollRowIntoView(F.getRow(G))}C.removeAll();C.add(G.hasChildNodes()?G.childNodes:[G])},updateStore:function(A){this.getBreadcrumb().setStore(A)},privates:{_onTreeSelectionChange:function(A,B){this.setSelection(B[0])},_onBreadcrumbSelectionChange:function(A,B){this.setSelection(B)}}});Ext.define("Ext.ux.FieldReplicator",{alias:"plugin.fieldreplicator",init:function(A){if(!A.replicatorId){A.replicatorId=Ext.id()}A.on("blur",this.onBlur,this)},onBlur:function(E){var G=E.ownerCt,B=E.replicatorId,D=Ext.isEmpty(E.getRawValue()),H=G.query("[replicatorId="+B+"]"),F=H[H.length-1]===E,A,C;if(D&&!F){Ext.Function.defer(E.destroy,10,E)}else{if(!D&&F){if(E.onReplicate){E.onReplicate()}A=E.cloneConfig({replicatorId:B});C=G.items.indexOf(E);G.add(C+1,A)}}}});Ext.define("Ext.ux.GMapPanel",{extend:"Ext.panel.Panel",alias:"widget.gmappanel",requires:["Ext.window.MessageBox"],initComponent:function(){Ext.applyIf(this,{plain:true,gmapType:"map",border:false});this.callParent()},onBoxReady:function(){var A=this.center;this.callParent(arguments);if(A){if(A.geoCodeAddr){this.lookupCode(A.geoCodeAddr,A.marker)}else{this.createMap(A)}}else{Ext.raise("center is required")}},createMap:function(C,B){var A=Ext.apply({},this.mapOptions);A=Ext.applyIf(A,{zoom:14,center:C,mapTypeId:google.maps.MapTypeId.HYBRID});this.gmap=new google.maps.Map(this.body.dom,A);if(B){this.addMarker(Ext.applyIf(B,{position:C}))}Ext.each(this.markers,this.addMarker,this);this.fireEvent("mapready",this,this.gmap)},addMarker:function(B){B=Ext.apply({map:this.gmap},B);if(!B.position){B.position=new google.maps.LatLng(B.lat,B.lng)}var A=new google.maps.Marker(B);Ext.Object.each(B.listeners,function(D,C){google.maps.event.addListener(A,D,C)});return A},lookupCode:function(B,A){this.geocoder=new google.maps.Geocoder();this.geocoder.geocode({address:B},Ext.Function.bind(this.onLookupComplete,this,[A],true))},onLookupComplete:function(C,B,A){if(B!="OK"){Ext.MessageBox.alert("Error",'An error occured: "'+B+'"');return}this.createMap(C[0].geometry.location,A)},afterComponentLayout:function(B,A){this.callParent(arguments);this.redraw()},redraw:function(){var A=this.gmap;if(A){google.maps.event.trigger(A,"resize")}}});Ext.define("Ext.ux.GroupTabRenderer",{extend:"Ext.plugin.Abstract",alias:"plugin.grouptabrenderer",tableTpl:new Ext.XTemplate('<div id="{view.id}-body" class="'+Ext.baseCSSPrefix+"{view.id}-table "+Ext.baseCSSPrefix+'grid-table-resizer" style="{tableStyle}">',"{%","values.view.renderRows(values.rows, values.viewStartIndex, out);","%}","</div>",{priority:5}),rowTpl:new Ext.XTemplate("{%",'Ext.Array.remove(values.itemClasses, "',Ext.baseCSSPrefix+'grid-row");','var dataRowCls = values.recordIndex === -1 ? "" : " '+Ext.baseCSSPrefix+'grid-data-row";',"%}",'<div {[values.rowId ? ("id=\\"" + values.rowId + "\\"") : ""]} ','data-boundView="{view.id}" ','data-recordId="{record.internalId}" ','data-recordIndex="{recordIndex}" ','class="'+Ext.baseCSSPrefix+'grouptab-row {[values.itemClasses.join(" ")]} {[values.rowClasses.join(" ")]}{[dataRowCls]}" ',"{rowAttr:attributes}>",'<tpl for="columns">{%',"parent.view.renderCell(values, parent.record, parent.recordIndex, parent.rowIndex, xindex - 1, out, parent)","%}","</tpl>","</div>",{priority:5}),cellTpl:new Ext.XTemplate('{%values.tdCls = values.tdCls.replace(" '+Ext.baseCSSPrefix+'grid-cell "," ");%}','<div class="'+Ext.baseCSSPrefix+'grouptab-cell {tdCls}" {tdAttr}>','<div {unselectableAttr} class="'+Ext.baseCSSPrefix+'grid-cell-inner" style="text-align: {align}; {style};">{value}</div>','<div class="x-grouptabs-corner x-grouptabs-corner-top-left"></div>','<div class="x-grouptabs-corner x-grouptabs-corner-bottom-left"></div>',"</div>",{priority:5}),selectors:{bodySelector:"div."+Ext.baseCSSPrefix+"grid-table-resizer",nodeContainerSelector:"div."+Ext.baseCSSPrefix+"grid-table-resizer",itemSelector:"div."+Ext.baseCSSPrefix+"grouptab-row",rowSelector:"div."+Ext.baseCSSPrefix+"grouptab-row",cellSelector:"div."+Ext.baseCSSPrefix+"grouptab-cell",getCellSelector:function(A){return A?A.getCellSelector():this.cellSelector}},init:function(C){var B=C.getView(),A=this;B.addTpl(A.tableTpl);B.addRowTpl(A.rowTpl);B.addCellTpl(A.cellTpl);Ext.apply(B,A.selectors)}});Ext.define("Ext.ux.GroupTabPanel",{extend:"Ext.Container",alias:"widget.grouptabpanel",requires:["Ext.tree.Panel","Ext.ux.GroupTabRenderer"],baseCls:Ext.baseCSSPrefix+"grouptabpanel",initComponent:function(A){var B=this;Ext.apply(B,A);B.store=B.createTreeStore();B.layout={type:"hbox",align:"stretch"};B.defaults={border:false};B.items=[{xtype:"treepanel",cls:"x-tree-panel x-grouptabbar",width:150,rootVisible:false,store:B.store,hideHeaders:true,animate:false,processEvent:Ext.emptyFn,border:false,plugins:[{ptype:"grouptabrenderer"}],viewConfig:{overItemCls:"",getRowClass:B.getRowClass},columns:[{xtype:"treecolumn",sortable:false,dataIndex:"text",flex:1,renderer:function(F,J,G,C,D,H,I){var E="";if(G.parentNode&&G.parentNode.parentNode===null){E+=" x-grouptab-first";if(G.previousSibling){E+=" x-grouptab-prev"}if(!G.get("expanded")||G.firstChild==null){E+=" x-grouptab-last"}}else{if(G.nextSibling===null){E+=" x-grouptab-last"}else{E+=" x-grouptab-center"}}if(G.data.activeTab){E+=" x-active-tab"}J.tdCls="x-grouptab"+E;return F}}]},{xtype:"container",flex:1,layout:"card",activeItem:B.mainItem,baseCls:Ext.baseCSSPrefix+"grouptabcontainer",items:B.cards}];B.callParent(arguments);B.setActiveTab(B.activeTab);B.setActiveGroup(B.activeGroup);B.mon(B.down("treepanel").getSelectionModel(),"select",B.onNodeSelect,B)},getRowClass:function(C,A,E,B){var D="";if(C.data.activeGroup){D+=" x-active-group"}return D},onNodeSelect:function(E,B){var C=this,A=C.store.getRootNode(),D;if(B.parentNode&&B.parentNode.parentNode===null){D=B}else{D=B.parentNode}if(C.setActiveGroup(D.get("id"))===false||C.setActiveTab(B.get("id"))===false){return false}while(A){A.set("activeTab",false);A.set("activeGroup",false);A=A.firstChild||A.nextSibling||A.parentNode.nextSibling}D.set("activeGroup",true);D.eachChild(function(F){F.set("activeGroup",true)});B.set("activeTab",true);E.view.refresh()},setActiveTab:function(C){var B=this,A=C,D;if(Ext.isString(C)){A=Ext.getCmp(A)}if(A===B.activeTab){return false}D=B.activeTab;if(B.fireEvent("beforetabchange",B,A,D)!==false){B.activeTab=A;if(B.rendered){B.down("container[baseCls="+Ext.baseCSSPrefix+"grouptabcontainer]").getLayout().setActiveItem(A)}B.fireEvent("tabchange",B,A,D)}return true},setActiveGroup:function(B){var A=this,D=B,C;if(Ext.isString(B)){D=Ext.getCmp(D)}if(D===A.activeGroup){return true}C=A.activeGroup;if(A.fireEvent("beforegroupchange",A,D,C)!==false){A.activeGroup=D;A.fireEvent("groupchange",A,D,C)}else{return false}return true},createTreeStore:function(){var C=this,B=C.prepareItems(C.items),D={text:".",children:[]},A=C.cards=[];C.activeGroup=C.activeGroup||0;Ext.each(B,function(F,G){var I=F.items.items,E=(I[F.mainItem]||I[0]),H={children:[]};H.id=E.id;H.text=E.title;H.iconCls=E.iconCls;H.expanded=true;H.activeGroup=(C.activeGroup===G);H.activeTab=H.activeGroup?true:false;if(H.activeTab){C.activeTab=H.id}if(H.activeGroup){C.mainItem=F.mainItem||0;C.activeGroup=H.id}Ext.each(I,function(J){if(J.id!==H.id){var K={id:J.id,leaf:true,text:J.title,iconCls:J.iconCls,activeGroup:H.activeGroup,activeTab:false};H.children.push(K)}delete J.title;delete J.iconCls;A.push(J)});D.children.push(H)});return Ext.create("Ext.data.TreeStore",{fields:["id","text","activeGroup","activeTab"],root:{expanded:true},proxy:{type:"memory",data:D}})},getActiveTab:function(){return this.activeTab},getActiveGroup:function(){return this.activeGroup}});Ext.define("Ext.ux.IFrame",{extend:"Ext.Component",alias:"widget.uxiframe",loadMask:"Loading...",src:"about:blank",renderTpl:['<iframe src="{src}" id="{id}-iframeEl" data-ref="iframeEl" name="{frameName}" width="100%" height="100%" frameborder="0"></iframe>'],childEls:["iframeEl"],initComponent:function(){this.callParent();this.frameName=this.frameName||this.id+"-frame"},initEvents:function(){var A=this;A.callParent();A.iframeEl.on("load",A.onLoad,A)},initRenderData:function(){return Ext.apply(this.callParent(),{src:this.src,frameName:this.frameName})},getBody:function(){var A=this.getDoc();return A.body||A.documentElement},getDoc:function(){try{return this.getWin().document}catch(A){return null}},getWin:function(){var B=this,C=B.frameName,A=Ext.isIE?B.iframeEl.dom.contentWindow:window.frames[C];return A},getFrame:function(){var A=this;return A.iframeEl.dom},beforeDestroy:function(){this.cleanupListeners(true);this.callParent()},cleanupListeners:function(A){var D,C;if(this.rendered){try{D=this.getDoc();if(D){Ext.get(D).un(this._docListeners);if(A){for(C in D){if(D.hasOwnProperty&&D.hasOwnProperty(C)){delete D[C]}}}}}catch(B){}}},onLoad:function(){var C=this,D=C.getDoc(),B=C.onRelayedEvent;if(D){try{Ext.get(D).on(C._docListeners={mousedown:B,mousemove:B,mouseup:B,click:B,dblclick:B,scope:C})}catch(A){}Ext.get(this.getWin()).on("beforeunload",C.cleanupListeners,C);this.el.unmask();this.fireEvent("load",this)}else{if(C.src){this.el.unmask();this.fireEvent("error",this)}}},onRelayedEvent:function(D){var C=this.iframeEl,B=C.getTrueXY(),E=D.getXY(),A=D.getTrueXY();D.xy=[B[0]+A[0],B[1]+A[1]];D.injectEvent(C);D.xy=E},load:function(D){var B=this,A=B.loadMask,C=B.getFrame();if(B.fireEvent("beforeload",B,D)!==false){if(A&&B.el){B.el.mask(A)}C.src=B.src=(D||B.src)}}});Ext.define("Ext.ux.statusbar.StatusBar",{extend:"Ext.toolbar.Toolbar",alternateClassName:"Ext.ux.StatusBar",alias:"widget.statusbar",requires:["Ext.toolbar.TextItem"],cls:"x-statusbar",busyIconCls:"x-status-busy",busyText:"Loading...",autoClear:5000,emptyText:"&#160;",activeThreadId:0,initComponent:function(){var A=this.statusAlign==="right";this.callParent(arguments);this.currIconCls=this.iconCls||this.defaultIconCls;this.statusEl=Ext.create("Ext.toolbar.TextItem",{cls:"x-status-text "+(this.currIconCls||""),text:this.text||this.defaultText||""});if(A){this.cls+=" x-status-right";this.add("->");this.add(this.statusEl)}else{this.insert(0,this.statusEl);this.insert(1,"->")}},setStatus:function(B){var C=this;B=B||{};Ext.suspendLayouts();if(Ext.isString(B)){B={text:B}}if(B.text!==undefined){C.setText(B.text)}if(B.iconCls!==undefined){C.setIcon(B.iconCls)}if(B.clear){var D=B.clear,E=C.autoClear,A={useDefaults:true,anim:true};if(Ext.isObject(D)){D=Ext.applyIf(D,A);if(D.wait){E=D.wait}}else{if(Ext.isNumber(D)){E=D;D=A}else{if(Ext.isBoolean(D)){D=A}}}D.threadId=this.activeThreadId;Ext.defer(C.clearStatus,E,C,[D])}Ext.resumeLayouts(true);return C},clearStatus:function(A){A=A||{};var B=this,C=B.statusEl;if(A.threadId&&A.threadId!==B.activeThreadId){return B}var D=A.useDefaults?B.defaultText:B.emptyText,E=A.useDefaults?(B.defaultIconCls?B.defaultIconCls:""):"";if(A.anim){C.el.puff({remove:false,useDisplay:true,callback:function(){C.el.show();B.setStatus({text:D,iconCls:E})}})}else{B.setStatus({text:D,iconCls:E})}return B},setText:function(B){var A=this;A.activeThreadId++;A.text=B||"";if(A.rendered){A.statusEl.setText(A.text)}return A},getText:function(){return this.text},setIcon:function(A){var B=this;B.activeThreadId++;A=A||"";if(B.rendered){if(B.currIconCls){B.statusEl.removeCls(B.currIconCls);B.currIconCls=null}if(A.length>0){B.statusEl.addCls(A);B.currIconCls=A}}else{B.currIconCls=A}return B},showBusy:function(A){if(Ext.isString(A)){A={text:A}}A=Ext.applyIf(A||{},{text:this.busyText,iconCls:this.busyIconCls});return this.setStatus(A)}});Ext.define("Ext.ux.LiveSearchGridPanel",{extend:"Ext.grid.Panel",requires:["Ext.toolbar.TextItem","Ext.form.field.Checkbox","Ext.form.field.Text","Ext.ux.statusbar.StatusBar"],searchValue:null,matches:[],currentIndex:null,searchRegExp:null,caseSensitive:false,regExpMode:false,matchCls:"x-livesearch-match",defaultStatusText:"Nothing Found",initComponent:function(){var A=this;A.tbar=["Search",{xtype:"textfield",name:"searchField",hideLabel:true,width:200,listeners:{change:{fn:A.onTextFieldChange,scope:this,buffer:500}}},{xtype:"button",text:"&lt;",tooltip:"Find Previous Row",handler:A.onPreviousClick,scope:A},{xtype:"button",text:"&gt;",tooltip:"Find Next Row",handler:A.onNextClick,scope:A},"-",{xtype:"checkbox",hideLabel:true,margin:"0 0 0 4px",handler:A.regExpToggle,scope:A},"Regular expression",{xtype:"checkbox",hideLabel:true,margin:"0 0 0 4px",handler:A.caseSensitiveToggle,scope:A},"Case sensitive"];A.bbar=new Ext.ux.StatusBar({defaultText:A.defaultStatusText,name:"searchStatusBar"});A.callParent(arguments)},afterRender:function(){var A=this;A.callParent(arguments);A.textField=A.down("textfield[name=searchField]");A.statusBar=A.down("statusbar[name=searchStatusBar]");A.view.on("cellkeydown",A.focusTextField,A)},focusTextField:function(G,D,C,F,E,B,A,H){if(A.getKey()===A.S){A.preventDefault();this.textField.focus()}},tagsRe:/<[^>]*>/gm,tagsProtect:"\x0f",getSearchValue:function(){var A=this,B=A.textField.getValue();if(B===""){return null}if(!A.regExpMode){B=Ext.String.escapeRegex(B)}else{try{new RegExp(B)}catch(C){A.statusBar.setStatus({text:C.message,iconCls:"x-status-error"});return null}if(B==="^"||B==="$"){return null}}return B},onTextFieldChange:function(){var C=this,A=0,D=C.view,B=D.cellSelector,E=D.innerSelector,F=C.visibleColumnManager.getColumns();D.refresh();C.statusBar.setStatus({text:C.defaultStatusText,iconCls:""});C.searchValue=C.getSearchValue();C.matches=[];C.currentIndex=null;if(C.searchValue!==null){C.searchRegExp=new RegExp(C.getSearchValue(),"g"+(C.caseSensitive?"":"i"));C.store.each(function(H,I){var G=D.getNode(H);if(G){Ext.Array.forEach(F,function(N){var M=Ext.fly(G).down(N.getCellInnerSelector(),true),K,L,J;if(M){K=M.innerHTML.match(C.tagsRe);L=M.innerHTML.replace(C.tagsRe,C.tagsProtect);L=L.replace(C.searchRegExp,function(O){++A;if(!J){C.matches.push({record:H,column:N});J=true}return'<span class="'+C.matchCls+'">'+O+"</span>"},C);Ext.each(K,function(O){L=L.replace(C.tagsProtect,O)});M.innerHTML=L}})}},C);if(A){C.currentIndex=0;C.gotoCurrent();C.statusBar.setStatus({text:Ext.String.format("{0} match{1} found.",A,A===1?"es":""),iconCls:"x-status-valid"})}}if(C.currentIndex===null){C.getSelectionModel().deselectAll();C.textField.focus()}},onPreviousClick:function(){var B=this,A=B.matches,C=A.length,D=B.currentIndex;if(C){B.currentIndex=D===0?C-1:D-1;B.gotoCurrent()}},onNextClick:function(){var B=this,A=B.matches,C=A.length,D=B.currentIndex;if(C){B.currentIndex=D===C-1?0:D+1;B.gotoCurrent()}},caseSensitiveToggle:function(A,B){this.caseSensitive=B;this.onTextFieldChange()},regExpToggle:function(A,B){this.regExpMode=B;this.onTextFieldChange()},privates:{gotoCurrent:function(){var A=this.matches[this.currentIndex];this.getNavigationModel().setPosition(A.record,A.column);this.getSelectionModel().select(A.record)}}});Ext.define("Ext.ux.PreviewPlugin",{extend:"Ext.plugin.Abstract",alias:"plugin.preview",requires:["Ext.grid.feature.RowBody"],hideBodyCls:"x-grid-row-body-hidden",bodyField:"",previewExpanded:true,setCmp:function(F){this.callParent(arguments);var D=this,G=D.cmp=F.isXType("gridview")?F.grid:F,B=D.bodyField,C=D.hideBodyCls,A=Ext.create("Ext.grid.feature.RowBody",{grid:G,getAdditionalData:function(M,J,L,I){var K=Ext.grid.feature.RowBody.prototype.getAdditionalData,H={rowBody:M[B],rowBodyCls:G.getView().previewExpanded?"":C};if(Ext.isFunction(K)){Ext.apply(H,K.apply(this,arguments))}return H}}),E=function(I,H){H.previewExpanded=D.previewExpanded;H.featuresMC.add(A);A.init(I)};if(G.view){E(G,G.view)}else{G.on({viewcreated:E,single:true})}},toggleExpanded:function(D){var E=this.getCmp(),B=E&&E.getView(),C=B.bufferedRenderer,A=B.scrollManager;if(E&&B&&D!==B.previewExpanded){this.previewExpanded=B.previewExpanded=!!D;B.refreshView();if(A){if(C){C.stretchView(B,C.getScrollHeight(true))}else{A.refresh(true)}}}}});Ext.define("Ext.ux.ProgressBarPager",{requires:["Ext.ProgressBar"],width:225,defaultText:"Loading...",defaultAnimCfg:{duration:1000,easing:"bounceOut"},constructor:function(A){if(A){Ext.apply(this,A)}},init:function(B){var A;if(B.displayInfo){this.parent=B;A=B.child("#displayItem");if(A){B.remove(A,true)}this.progressBar=Ext.create("Ext.ProgressBar",{text:this.defaultText,width:this.width,animate:this.defaultAnimCfg,style:{cursor:"pointer"},listeners:{el:{scope:this,click:this.handleProgressBarClick}}});B.displayItem=this.progressBar;B.add(B.displayItem);Ext.apply(B,this.parentOverrides)}},handleProgressBarClick:function(A){var H=this.parent,G=H.displayItem,E=this.progressBar.getBox(),D=A.getXY(),F=D[0]-E.x,C=Math.ceil(H.store.getTotalCount()/H.pageSize),B=Math.max(Math.ceil(F/(G.width/C)),1);H.store.loadPage(B)},parentOverrides:{updateInfo:function(){if(this.displayItem){var B=this.store.getCount(),C=this.getPageData(),D=B===0?this.emptyMsg:Ext.String.format(this.displayMsg,C.fromRecord,C.toRecord,this.store.getTotalCount()),A=C.pageCount>0?(C.currentPage/C.pageCount):0;this.displayItem.updateProgress(A,D,this.animate||this.defaultAnimConfig)}}}});Ext.define("Ext.ux.RowExpander",{extend:"Ext.grid.plugin.RowExpander"});Ext.define("Ext.ux.SlidingPager",{requires:["Ext.slider.Single","Ext.slider.Tip"],constructor:function(A){if(A){Ext.apply(this,A)}},init:function(A){var B=A.items.indexOf(A.child("#inputItem")),C;Ext.each(A.items.getRange(B-2,B+2),function(D){D.hide()});C=Ext.create("Ext.slider.Single",{width:114,minValue:1,maxValue:1,hideLabel:true,tipText:function(D){return Ext.String.format("Page <b>{0}</b> of <b>{1}</b>",D.value,D.slider.maxValue)},listeners:{changecomplete:function(D,E){A.store.loadPage(E)}}});A.insert(B+1,C);A.on({change:function(D,E){C.setMaxValue(E.pageCount);C.setValue(E.currentPage)}})}});Ext.define("Ext.ux.Spotlight",{baseCls:"x-spotlight",animate:true,duration:250,easing:null,active:false,constructor:function(A){Ext.apply(this,A)},createElements:function(){var C=this,A=C.baseCls,B=Ext.getBody();C.right=B.createChild({cls:A});C.left=B.createChild({cls:A});C.top=B.createChild({cls:A});C.bottom=B.createChild({cls:A});C.all=Ext.create("Ext.CompositeElement",[C.right,C.left,C.top,C.bottom])},show:function(A,D,C){var B=this;B.el=Ext.get(A);if(!B.right){B.createElements()}if(!B.active){B.all.setDisplayed("");B.active=true;Ext.on("resize",B.syncSize,B);B.applyBounds(B.animate,false)}else{B.applyBounds(false,false)}},hide:function(A,C){var B=this;Ext.un("resize",B.syncSize,B);B.applyBounds(B.animate,true)},syncSize:function(){this.applyBounds(false,false)},applyBounds:function(E,D){var I=this,F=I.el.getBox(),K=Ext.Element.getViewportWidth(),B=Ext.Element.getViewportHeight(),G=0,A=false,H,J,C;H={right:{x:F.right,y:B,width:(K-F.right),height:0},left:{x:0,y:0,width:F.x,height:0},top:{x:K,y:0,width:0,height:F.y},bottom:{x:0,y:(F.y+F.height),width:0,height:(B-(F.y+F.height))+"px"}};J={right:{x:F.right,y:F.y,width:(K-F.right)+"px",height:(B-F.y)+"px"},left:{x:0,y:0,width:F.x+"px",height:(F.y+F.height)+"px"},top:{x:F.x,y:0,width:(K-F.x)+"px",height:F.y+"px"},bottom:{x:0,y:(F.y+F.height),width:(F.x+F.width)+"px",height:(B-(F.y+F.height))+"px"}};if(D){C=Ext.clone(H);H=J;J=C}if(E){Ext.Array.forEach(["right","left","top","bottom"],function(L){I[L].setBox(H[L]);I[L].animate({duration:I.duration,easing:I.easing,to:J[L]})},this)}else{Ext.Array.forEach(["right","left","top","bottom"],function(L){I[L].setBox(Ext.apply(H[L],J[L]));I[L].repaint()},this)}},destroy:function(){var A=this;Ext.destroy(A.right,A.left,A.top,A.bottom);delete A.el;delete A.all;A.callParent()}});Ext.define("Ext.ux.TabCloseMenu",{extend:"Ext.plugin.Abstract",alias:"plugin.tabclosemenu",mixins:{observable:"Ext.util.Observable"},closeTabText:"Close Tab",showCloseOthers:true,closeOthersTabsText:"Close Other Tabs",showCloseAll:true,closeAllTabsText:"Close All Tabs",extraItemsHead:null,extraItemsTail:null,constructor:function(A){this.callParent([A]);this.mixins.observable.constructor.call(this,A)},init:function(A){this.tabPanel=A;this.tabBar=A.down("tabbar");this.mon(this.tabPanel,{scope:this,afterlayout:this.onAfterLayout,single:true})},onAfterLayout:function(){this.mon(this.tabBar.el,{scope:this,contextmenu:this.onContextMenu,delegate:".x-tab"})},destroy:function(){this.callParent();Ext.destroy(this.menu)},onContextMenu:function(G,F){var A=this,E=A.createMenu(),H=true,D=true,C=A.tabBar.getChildByElement(F),B=A.tabBar.items.indexOf(C);A.item=A.tabPanel.getComponent(B);E.child("#close").setDisabled(!A.item.closable);if(A.showCloseAll||A.showCloseOthers){A.tabPanel.items.each(function(I){if(I.closable){H=false;if(I!==A.item){D=false;return false}}return true});if(A.showCloseAll){E.child("#closeAll").setDisabled(H)}if(A.showCloseOthers){E.child("#closeOthers").setDisabled(D)}}G.preventDefault();A.fireEvent("beforemenu",E,A.item,A);E.showAt(G.getXY())},createMenu:function(){var A=this;if(!A.menu){var B=[{itemId:"close",text:A.closeTabText,scope:A,handler:A.onClose}];if(A.showCloseAll||A.showCloseOthers){B.push("-")}if(A.showCloseOthers){B.push({itemId:"closeOthers",text:A.closeOthersTabsText,scope:A,handler:A.onCloseOthers})}if(A.showCloseAll){B.push({itemId:"closeAll",text:A.closeAllTabsText,scope:A,handler:A.onCloseAll})}if(A.extraItemsHead){B=A.extraItemsHead.concat(B)}if(A.extraItemsTail){B=B.concat(A.extraItemsTail)}A.menu=Ext.create("Ext.menu.Menu",{items:B,listeners:{hide:A.onHideMenu,scope:A}})}return A.menu},onHideMenu:function(){var A=this;A.fireEvent("aftermenu",A.menu,A)},onClose:function(){this.tabPanel.remove(this.item)},onCloseOthers:function(){this.doClose(true)},onCloseAll:function(){this.doClose(false)},doClose:function(A){var B=[];this.tabPanel.items.each(function(C){if(C.closable){if(!A||C!==this.item){B.push(C)}}},this);Ext.suspendLayouts();Ext.Array.forEach(B,function(C){this.tabPanel.remove(C)},this);Ext.resumeLayouts(true)}});Ext.define("Ext.ux.TabReorderer",{extend:"Ext.ux.BoxReorderer",alias:"plugin.tabreorderer",itemSelector:"."+Ext.baseCSSPrefix+"tab",init:function(B){var A=this;A.callParent([B.getTabBar()]);B.onAdd=Ext.Function.createSequence(B.onAdd,A.onAdd)},onBoxReady:function(){var C,D,A=0,B;this.callParent(arguments);for(C=this.container.items.items,D=C.length;A<D;A++){B=C[A];if(B.card){B.reorderable=B.card.reorderable}}},onAdd:function(A,B){A.tab.reorderable=A.reorderable},afterBoxReflow:function(){var A=this;Ext.ux.BoxReorderer.prototype.afterBoxReflow.apply(A,arguments);if(A.dragCmp){A.container.tabPanel.setActiveTab(A.dragCmp.card);A.container.tabPanel.move(A.dragCmp.card,A.curIndex)}}});Ext.ns("Ext.ux");Ext.define("Ext.ux.TabScrollerMenu",{alias:"plugin.tabscrollermenu",requires:["Ext.menu.Menu"],pageSize:10,maxText:15,menuPrefixText:"Items",constructor:function(A){Ext.apply(this,A)},init:function(B){var A=this;A.tabPanel=B;B.on({render:function(){A.tabBar=B.tabBar;A.layout=A.tabBar.layout;A.layout.overflowHandler.handleOverflow=Ext.Function.bind(A.showButton,A);A.layout.overflowHandler.clearOverflow=Ext.Function.createSequence(A.layout.overflowHandler.clearOverflow,A.hideButton,A)},destroy:A.destroy,scope:A,single:true})},showButton:function(){var C=this,B=Ext.getClass(C.layout.overflowHandler).prototype.handleOverflow.apply(C.layout.overflowHandler,arguments),A=C.menuButton;if(C.tabPanel.items.getCount()>1){if(!A){A=C.menuButton=C.tabBar.body.createChild({cls:Ext.baseCSSPrefix+"tab-tabmenu-right"},C.tabBar.body.child("."+Ext.baseCSSPrefix+"box-scroller-right"));A.addClsOnOver(Ext.baseCSSPrefix+"tab-tabmenu-over");A.on("click",C.showTabsMenu,C)}A.setVisibilityMode(Ext.dom.Element.DISPLAY);A.show();B.reservedSpace+=A.getWidth()}else{C.hideButton()}return B},hideButton:function(){var A=this;if(A.menuButton){A.menuButton.hide()}},getPageSize:function(){return this.pageSize},setPageSize:function(A){this.pageSize=A},getMaxText:function(){return this.maxText},setMaxText:function(A){this.maxText=A},getMenuPrefixText:function(){return this.menuPrefixText},setMenuPrefixText:function(A){this.menuPrefixText=A},showTabsMenu:function(B){var C=this;if(C.tabsMenu){C.tabsMenu.removeAll()}else{C.tabsMenu=new Ext.menu.Menu()}C.generateTabMenuItems();var D=Ext.get(B.getTarget()),A=D.getXY();A[1]+=24;C.tabsMenu.showAt(A)},generateTabMenuItems:function(){var A=this,P=A.tabPanel,H=P.getActiveTab(),K=P.items.getRange(),C=A.getPageSize(),O=A.tabsMenu,I,B,G,L,E,N,F,J,M,D;O.suspendLayouts();K=Ext.Array.filter(K,function(Q){if(Q.id==H.id){return false}return Q.hidden?!!Q.hiddenByLayout:true});I=K.length;B=Math.floor(I/C);G=I%C;if(I>C){for(L=0;L<B;L++){E=(L+1)*C;N=[];for(F=0;F<C;F++){D=F+E-C;J=K[D];N.push(A.autoGenMenuItem(J))}O.add({text:A.getMenuPrefixText()+" "+(E-C+1)+" - "+E,menu:N})}if(G>0){M=B*C;N=[];for(L=M;L<I;L++){J=K[L];N.push(A.autoGenMenuItem(J))}A.tabsMenu.add({text:A.menuPrefixText+" "+(M+1)+" - "+(M+N.length),menu:N})}}else{for(L=0;L<I;++L){O.add(A.autoGenMenuItem(K[L]))}}O.resumeLayouts(true)},autoGenMenuItem:function(A){var B=this.getMaxText(),C=Ext.util.Format.ellipsis(A.title,B);return{text:C,handler:this.showTabFromMenu,scope:this,disabled:A.disabled,tabToShow:A,iconCls:A.iconCls}},showTabFromMenu:function(A){this.tabPanel.setActiveTab(A.tabToShow)},destroy:function(){Ext.destroy(this.tabsMenu,this.menuButton);this.callParent()}});Ext.define("Ext.ux.ToolbarDroppable",{constructor:function(A){Ext.apply(this,A)},init:function(A){this.toolbar=A;this.toolbar.on({scope:this,render:this.createDropTarget})},createDropTarget:function(){this.dropTarget=Ext.create("Ext.dd.DropTarget",this.toolbar.getEl(),{notifyOver:Ext.Function.bind(this.notifyOver,this),notifyDrop:Ext.Function.bind(this.notifyDrop,this)})},addDDGroup:function(A){this.dropTarget.addToGroup(A)},calculateEntryIndex:function(A){var C=0,G=this.toolbar,J=G.items.items,I=J.length,K=A.getXY()[0],B=0,E,F,H,D;for(;B<I;B++){E=J[B].getEl();F=E.getXY()[0];H=E.getWidth();D=F+H/2;if(K<D){C=B;break}else{C=B+1}}return C},canDrop:function(A){return true},notifyOver:function(A,B,C){return this.canDrop.apply(this,arguments)?this.dropTarget.dropAllowed:this.dropTarget.dropNotAllowed},notifyDrop:function(B,C,F){var D=this.canDrop(B,C,F),A=this.toolbar;if(D){var E=this.calculateEntryIndex(C);A.insert(E,this.createItem(F));this.afterLayout()}return D},createItem:function(A){Ext.raise("The createItem method must be implemented in the ToolbarDroppable plugin")},afterLayout:Ext.emptyFn});Ext.define("Ext.ux.TreePicker",{extend:"Ext.form.field.Picker",xtype:"treepicker",uses:["Ext.tree.Panel"],triggerCls:Ext.baseCSSPrefix+"form-arrow-trigger",config:{store:null,displayField:null,columns:null,selectOnTab:true,maxPickerHeight:300,minPickerHeight:100},editable:false,initComponent:function(){var A=this;A.callParent(arguments);A.mon(A.store,{scope:A,load:A.onLoad,update:A.onUpdate})},createPicker:function(){var A=this,B=new Ext.tree.Panel({baseCls:Ext.baseCSSPrefix+"boundlist",shrinkWrapDock:2,store:A.store,floating:true,displayField:A.displayField,columns:A.columns,minHeight:A.minPickerHeight,maxHeight:A.maxPickerHeight,manageHeight:false,shadow:false,listeners:{scope:A,itemclick:A.onItemClick,itemkeydown:A.onPickerKeyDown}}),C=B.getView();if(Ext.isIE9&&Ext.isStrict){C.on({scope:A,highlightitem:A.repaintPickerView,unhighlightitem:A.repaintPickerView,afteritemexpand:A.repaintPickerView,afteritemcollapse:A.repaintPickerView})}return B},repaintPickerView:function(){var A=this.picker.getView().getEl().dom.style;A.display=A.display},onItemClick:function(D,E,C,A,B){this.selectItem(E)},onPickerKeyDown:function(C,E,D,F,B){var A=B.getKey();if(A===B.ENTER||(A===B.TAB&&this.selectOnTab)){this.selectItem(E)}},selectItem:function(B){var A=this;A.setValue(B.getId());A.fireEvent("select",A,B);A.collapse()},onExpand:function(){var C=this.picker,A=C.store,D=this.value,B;if(D){B=A.getNodeById(D)}if(!B){B=A.getRoot()}C.ensureVisible(B,{select:true,focus:true})},setValue:function(B){var A=this,C;A.value=B;if(A.store.loading){return A}C=B?A.store.getNodeById(B):A.store.getRoot();if(B===undefined){C=A.store.getRoot();A.value=C.getId()}else{C=A.store.getNodeById(B)}A.setRawValue(C?C.get(A.displayField):"");return A},getSubmitValue:function(){return this.value},getValue:function(){return this.value},onLoad:function(){var A=this.value;if(A){this.setValue(A)}},onUpdate:function(B,A,E,D){var C=this.displayField;if(E==="edit"&&D&&Ext.Array.contains(D,C)&&this.value===A.getId()){this.setRawValue(A.get(C))}}});Ext.define("Ext.ux.colorpick.Selection",{mixinId:"colorselection",config:{format:"hex6",value:"FF0000",color:null,previousColor:null},applyColor:function(B){var A=B;if(Ext.isString(A)){A=Ext.ux.colorpick.ColorUtils.parseColor(B)}return A},applyValue:function(B){var A=Ext.ux.colorpick.ColorUtils.parseColor(B);return this.formatColor(A)},formatColor:function(A){return Ext.ux.colorpick.ColorUtils.formats[this.getFormat()](A)},updateColor:function(B){var A=this;if(!A.syncing){A.syncing=true;A.setValue(A.formatColor(B));A.syncing=false}},updateValue:function(C,A){var B=this;if(!B.syncing){B.syncing=true;B.setColor(C);B.syncing=false}this.fireEvent("change",B,C,A)}});Ext.define("Ext.ux.colorpick.ColorUtils",function(A){var B=Ext.isIE&&Ext.ieVersion<10;return{singleton:true,constructor:function(){A=this},backgroundTpl:B?"filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr='#{alpha}{hex}', endColorstr='#{alpha}{hex}');":"background: {rgba};",setBackground:B?function(C,F){if(C){var E=Ext.XTemplate.getTpl(A,"backgroundTpl"),G={hex:A.rgb2hex(F.r,F.g,F.b),alpha:Math.floor(F.a*255).toString(16)},D=E.apply(G);C.applyStyles(D)}}:function(C,F){if(C){var E=Ext.XTemplate.getTpl(A,"backgroundTpl"),G={rgba:A.getRGBAString(F)},D=E.apply(G);C.applyStyles(D)}},formats:{HEX6:function(C){return A.rgb2hex(C.r,C.g,C.b)},HEX8:function(E){var D=A.rgb2hex(E.r,E.g,E.b),C=Math.round(E.a*255).toString(16);if(C.length<2){D+="0"}D+=C.toUpperCase();return D}},hexRe:/#?([0-9a-f]{3,8})/i,rgbaAltRe:/rgba\(\s*([\w#\d]+)\s*,\s*([\d\.]+)\s*\)/,rgbaRe:/rgba\(\s*([\d\.]+)\s*,\s*([\d\.]+)\s*,\s*([\d\.]+)\s*,\s*([\d\.]+)\s*\)/,rgbRe:/rgb\(\s*([\d\.]+)\s*,\s*([\d\.]+)\s*,\s*([\d\.]+)\s*\)/,parseColor:function(H){if(!H){return null}var F=this,E=F.colorMap[H],D,G,C;if(E){G={r:E[0],g:E[1],b:E[2],a:1}}else{if(H==="transparent"){G={r:0,g:0,b:0,a:0}}else{D=F.hexRe.exec(H);if(D){D=D[1];switch(D.length){default:return null;case 3:G={r:parseInt(D[0]+D[0],16),g:parseInt(D[1]+D[1],16),b:parseInt(D[2]+D[2],16),a:1};break;case 6:case 8:G={r:parseInt(D.substr(0,2),16),g:parseInt(D.substr(2,2),16),b:parseInt(D.substr(4,2),16),a:parseInt(D.substr(6,2)||"ff",16)/255};break}}else{D=F.rgbaRe.exec(H);if(D){G={r:parseFloat(D[1]),g:parseFloat(D[2]),b:parseFloat(D[3]),a:parseFloat(D[4])}}else{D=F.rgbaAltRe.exec(H);if(D){G=F.parseColor(D[1]);G.a=parseFloat(D[2]);return G}D=F.rgbRe.exec(H);if(D){G={r:parseFloat(D[1]),g:parseFloat(D[2]),b:parseFloat(D[3]),a:1}}else{return null}}}}}C=this.rgb2hsv(G.r,G.g,G.b);return Ext.apply(G,C)},getRGBAString:function(C){return"rgba("+C.r+","+C.g+","+C.b+","+C.a+")"},getRGBString:function(C){return"rgb("+C.r+","+C.g+","+C.b+")"},hsv2rgb:function(G,C,E){G=G*360;if(G===360){G=0}var I=E*C;var F=G/60;var J=I*(1-Math.abs(F%2-1));var D=[0,0,0];switch(Math.floor(F)){case 0:D=[I,J,0];break;case 1:D=[J,I,0];break;case 2:D=[0,I,J];break;case 3:D=[0,J,I];break;case 4:D=[J,0,I];break;case 5:D=[I,0,J];break;default:console.error("unknown color "+G+" "+C+" "+E);break}var H=E-I;D[0]+=H;D[1]+=H;D[2]+=H;D[0]=Math.round(D[0]*255);D[1]=Math.round(D[1]*255);D[2]=Math.round(D[2]*255);return{r:D[0],g:D[1],b:D[2]}},rgb2hsv:function(C,L,J){C=C/255;L=L/255;J=J/255;var G=Math.max(C,L,J);var I=Math.min(C,L,J);var K=G-I;var E=0;if(K!==0){if(G===C){E=((L-J)/K)%6}else{if(G===L){E=((J-C)/K)+2}else{if(G===J){E=((C-L)/K)+4}}}}var H=E*60;if(H===360){H=0}var F=G;var D=0;if(K!==0){D=K/F}H=H/360;if(H<0){H=H+1}return{h:H,s:D,v:F}},rgb2hex:function(D,C,E){D=D.toString(16);C=C.toString(16);E=E.toString(16);if(D.length<2){D="0"+D}if(C.length<2){C="0"+C}if(E.length<2){E="0"+E}return(D+C+E).toUpperCase()},colorMap:{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]}}},function(C){var A=C.formats,B={};A["#HEX6"]=function(D){return"#"+A.HEX6(D)};A["#HEX8"]=function(D){return"#"+A.HEX8(D)};Ext.Object.each(A,function(E,D){B[E.toLowerCase()]=function(G){var F=D(G);return F.toLowerCase()}});Ext.apply(A,B)});Ext.define("Ext.ux.colorpick.ColorMapController",{extend:"Ext.app.ViewController",alias:"controller.colorpickercolormapcontroller",requires:["Ext.ux.colorpick.ColorUtils"],onFirstBoxReady:function(){var C=this,A=C.getView(),B=A.down("#dragHandle"),D=B.dd;D.constrain=true;D.constrainTo=A.getEl();D.initialConstrainTo=D.constrainTo;D.on("drag",Ext.bind(C.onHandleDrag,C));C.mon(A.getEl(),{mousedown:C.onMouseDown,dragstart:C.onDragStart,scope:C})},onHandleDrag:function(E,A){var I=this,H=I.getView(),C=H.down("#dragHandle"),J=C.getX()-H.getX(),K=C.getY()-H.getY(),D=H.getEl(),B=D.getWidth(),L=D.getHeight(),F=J/B,G=K/L;if(F>0.99){F=1}if(G>0.99){G=1}H.fireEvent("handledrag",F,G)},onMouseDown:function(A){var C=this,D=C.getView(),B=D.down("#dragHandle");B.setY(A.getY());B.setX(A.getX());C.onHandleDrag();B.dd.onMouseDown(A,B.dd.el)},onDragStart:function(A){var C=this,D=C.getView(),B=D.down("#dragHandle");B.dd.onDragStart(A,B.dd.el)},onMapClick:function(A){var H=this,G=H.getView(),B=G.down("#dragHandle"),E=G.getXY(),F=A.getXY(),C,D;C=F[0]-E[0];D=F[1]-E[1];B.getEl().setStyle({left:C+"px",top:D+"px"});H.onHandleDrag()},onColorBindingChanged:function(D){var A=this,M=A.getViewModel(),L=M.get("selectedColor"),J,K=A.getView(),C=K.down("#dragHandle"),I=K.getEl(),B=I.getWidth(),N=I.getHeight(),G,H,F,E;J=Ext.ux.colorpick.ColorUtils.rgb2hsv(L.r,L.g,L.b);G=J.s;F=B*G;H=1-J.v;E=N*H;C.getEl().setStyle({left:F+"px",top:E+"px"})},onHueBindingChanged:function(A){var C=this,D=C.getViewModel(),E,B;E=Ext.ux.colorpick.ColorUtils.hsv2rgb(A,1,1);B=Ext.ux.colorpick.ColorUtils.rgb2hex(E.r,E.g,E.b);C.getView().getEl().applyStyles({"background-color":"#"+B})}});Ext.define("Ext.ux.colorpick.ColorMap",{extend:"Ext.container.Container",alias:"widget.colorpickercolormap",controller:"colorpickercolormapcontroller",requires:["Ext.ux.colorpick.ColorMapController"],cls:Ext.baseCSSPrefix+"colorpicker-colormap",items:[{xtype:"component",cls:Ext.baseCSSPrefix+"colorpicker-colormap-draghandle-container",itemId:"dragHandle",width:1,height:1,draggable:true,html:'<div class="'+Ext.baseCSSPrefix+'colorpicker-colormap-draghandle"></div>'}],listeners:{boxready:{single:true,fn:"onFirstBoxReady",scope:"controller"},colorbindingchanged:{fn:"onColorBindingChanged",scope:"controller"},huebindingchanged:{fn:"onHueBindingChanged",scope:"controller"}},afterRender:function(){var B=this,C=B.mapGradientUrl,A=B.el;B.callParent();if(!C){C=A.getStyle("background-image");C=C.substring(4,C.length-1);if(C.indexOf('"')===0){C=C.substring(1,C.length-1)}Ext.ux.colorpick.ColorMap.prototype.mapGradientUrl=C}A.setStyle("background-image","none");A=B.layout.getElementTarget();A.createChild({tag:"img",cls:Ext.baseCSSPrefix+"colorpicker-colormap-blender",src:C})},setPosition:function(C){var B=this,A=B.down("#dragHandle");if(!A.dd||!A.dd.constrain){return}if(typeof A.dd.dragEnded!=="undefined"&&!A.dd.dragEnded){return}B.fireEvent("colorbindingchanged",C)},setHue:function(A){var B=this;if(!B.getEl()){return}B.fireEvent("huebindingchanged",A)}});Ext.define("Ext.ux.colorpick.SelectorModel",{extend:"Ext.app.ViewModel",alias:"viewmodel.colorpick-selectormodel",requires:["Ext.ux.colorpick.ColorUtils"],data:{selectedColor:{r:255,g:255,b:255,h:0,s:1,v:1,a:1},previousColor:{r:0,g:0,b:0,h:0,s:1,v:1,a:1}},formulas:{hex:{get:function(B){var C=B("selectedColor.r").toString(16),A=B("selectedColor.g").toString(16),E=B("selectedColor.b").toString(16),D;D=Ext.ux.colorpick.ColorUtils.rgb2hex(C,A,E);return"#"+D},set:function(B){var A=Ext.ux.colorpick.ColorUtils.hex2rgb(B);this.changeRGB(A)}},red:{get:function(A){return A("selectedColor.r")},set:function(A){this.changeRGB({r:A})}},green:{get:function(A){return A("selectedColor.g")},set:function(A){this.changeRGB({g:A})}},blue:{get:function(A){return A("selectedColor.b")},set:function(A){this.changeRGB({b:A})}},hue:{get:function(A){return A("selectedColor.h")*360},set:function(A){this.changeHSV({h:A/360})}},saturation:{get:function(A){return A("selectedColor.s")*100},set:function(A){this.changeHSV({s:A/100})}},value:{get:function(A){var B=A("selectedColor.v");return B*100},set:function(A){this.changeHSV({v:A/100})}},alpha:{get:function(B){var A=B("selectedColor.a");return A*100},set:function(A){this.set("selectedColor",Ext.applyIf({a:A/100},this.data.selectedColor))}}},changeHSV:function(A){Ext.applyIf(A,this.data.selectedColor);var B=Ext.ux.colorpick.ColorUtils.hsv2rgb(A.h,A.s,A.v);A.r=B.r;A.g=B.g;A.b=B.b;this.set("selectedColor",A)},changeRGB:function(B){Ext.applyIf(B,this.data.selectedColor);var A=Ext.ux.colorpick.ColorUtils.rgb2hsv(B.r,B.g,B.b);B.h=A.h;B.s=A.s;B.v=A.v;this.set("selectedColor",B)}});Ext.define("Ext.ux.colorpick.SelectorController",{extend:"Ext.app.ViewController",alias:"controller.colorpick-selectorcontroller",requires:["Ext.ux.colorpick.ColorUtils"],initViewModel:function(){var A=this,B=A.getView();B.childViewModel.bind("{selectedColor}",function(C){B.setColor(C)})},destroy:function(){var B=this,C=B.getView(),A=C.childViewModel;if(A){A.destroy();C.childViewModel=null}B.callParent()},changeHSV:function(A){var C=this.getView(),D=C.getColor(),B;Ext.applyIf(A,D);B=Ext.ux.colorpick.ColorUtils.hsv2rgb(A.h,A.s,A.v);Ext.apply(A,B);C.setColor(A)},onColorMapHandleDrag:function(B,A){this.changeHSV({s:B,v:1-A})},onValueSliderHandleDrag:function(A){this.changeHSV({v:1-A})},onSaturationSliderHandleDrag:function(A){this.changeHSV({s:1-A})},onHueSliderHandleDrag:function(A){this.changeHSV({h:1-A})},onAlphaSliderHandleDrag:function(B){var C=this.getView(),D=C.getColor(),A=Ext.applyIf({a:1-B},D);C.setColor(A);C.el.repaint()},onPreviousColorSelected:function(C,B){var A=this.getView();A.setColor(B)},onOK:function(){var A=this,B=A.getView();B.fireEvent("ok",B,B.getValue())},onCancel:function(){this.fireViewEvent("cancel",this.getView())},onResize:function(){var F=this,A=F.getView(),G=A.childViewModel,C=F.getReferences(),E,B,D,H;if(!F.hasResizedOnce){F.hasResizedOnce=true;return}E=G.get("hue");B=G.get("saturation");D=G.get("value");H=G.get("alpha");console.log("h="+E);C.colorMap.setPosition(G.getData());C.hueSlider.setHue(E);C.satSlider.setSaturation(B);C.valueSlider.setValue(D);C.alphaSlider.setAlpha(H)}});Ext.define("Ext.ux.colorpick.ColorPreview",{extend:"Ext.Component",alias:"widget.colorpickercolorpreview",requires:["Ext.util.Format"],style:"position: relative",html:'<div class="filter" style="height:100%; width:100%; position: absolute;"></div><a class="btn" style="height:100%; width:100%; position: absolute;"></a>',cls:"x-colorpreview",height:256,onRender:function(){var A=this;A.callParent(arguments);A.mon(A.el.down(".btn"),"click",A.onClick,A)},onClick:function(){this.fireEvent("click",this,this.color)},setColor:function(C){var B=this,A=B.getEl();if(!A){return}B.color=C;B.applyBgStyle(C)},bgStyleTpl:Ext.create("Ext.XTemplate",Ext.isIE&&Ext.ieVersion<10?"filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr='#{hexAlpha}{hex}', endColorstr='#{hexAlpha}{hex}');":"background: {rgba};"),applyBgStyle:function(C){var A=this,B=Ext.ux.colorpick.ColorUtils,G=A.getEl().down(".filter"),E,D,F,H;E=B.rgb2hex(C.r,C.g,C.b);D=Ext.util.Format.hex(Math.floor(C.a*255),2);F=B.getRGBAString(C);H=this.bgStyleTpl.apply({hex:E,hexAlpha:D,rgba:F});G.applyStyles(H)}});Ext.define("Ext.ux.colorpick.SliderController",{extend:"Ext.app.ViewController",alias:"controller.colorpick-slidercontroller",boxReady:function(C){var A=this,D=A.getDragContainer(),B=A.getDragHandle(),E=B.dd;E.constrain=true;E.constrainTo=D.getEl();E.initialConstrainTo=E.constrainTo;E.on("drag",A.onHandleDrag,A)},getDragHandle:function(){return this.view.lookupReference("dragHandle")},getDragContainer:function(){return this.view.lookupReference("dragHandleContainer")},onHandleDrag:function(D){var G=this,A=G.getView(),F=G.getDragContainer(),B=G.getDragHandle(),H=B.getY()-F.getY(),C=F.getEl(),I=C.getHeight(),E=H/I;if(E>0.99){E=1}A.fireEvent("handledrag",E)},onMouseDown:function(A){var C=this,B=C.getDragHandle(),D=A.getY();B.setY(D);C.onHandleDrag();B.el.repaint();B.dd.onMouseDown(A,B.dd.el)},onDragStart:function(A){var C=this,B=C.getDragHandle();B.dd.onDragStart(A,B.dd.el)},onMouseUp:function(){var A=this.getDragHandle();A.dd.dragEnded=true}});Ext.define("Ext.ux.colorpick.Slider",{extend:"Ext.container.Container",xtype:"colorpickerslider",controller:"colorpick-slidercontroller",baseCls:Ext.baseCSSPrefix+"colorpicker-slider",layout:"center",requires:["Ext.layout.container.Center","Ext.ux.colorpick.SliderController"],referenceHolder:true,listeners:{element:"el",mousedown:"onMouseDown",mouseup:"onMouseUp",dragstart:"onDragStart"},items:{xtype:"container",cls:Ext.baseCSSPrefix+"colorpicker-draghandle-container",reference:"dragHandleContainer",height:"100%",items:{xtype:"component",cls:Ext.baseCSSPrefix+"colorpicker-draghandle-outer",reference:"dragHandle",width:"100%",height:1,draggable:true,html:'<div class="'+Ext.baseCSSPrefix+'colorpicker-draghandle"></div>'}},setHue:function(){Ext.raise("Must implement setHue() in a child class!")},getDragHandle:function(){return this.lookupReference("dragHandle")},getDragContainer:function(){return this.lookupReference("dragHandleContainer")}});Ext.define("Ext.ux.colorpick.SliderAlpha",{extend:"Ext.ux.colorpick.Slider",alias:"widget.colorpickerslideralpha",cls:Ext.baseCSSPrefix+"colorpicker-alpha",requires:["Ext.XTemplate"],gradientStyleTpl:Ext.create("Ext.XTemplate",Ext.isIE&&Ext.ieVersion<10?"filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr='#FF{hex}', endColorstr='#00{hex}');":"background: -mox-linear-gradient(top, rgba({r}, {g}, {b}, 1) 0%, rgba({r}, {g}, {b}, 0) 100%);background: -webkit-linear-gradient(top,rgba({r}, {g}, {b}, 1) 0%, rgba({r}, {g}, {b}, 0) 100%);background: -o-linear-gradient(top, rgba({r}, {g}, {b}, 1) 0%, rgba({r}, {g}, {b}, 0) 100%);background: -ms-linear-gradient(top, rgba({r}, {g}, {b}, 1) 0%, rgba({r}, {g}, {b}, 0) 100%);background: linear-gradient(to bottom, rgba({r}, {g}, {b}, 1) 0%, rgba({r}, {g}, {b}, 0) 100%);"),setAlpha:function(D){var F=this,E=F.getDragContainer(),A=F.getDragHandle(),B=E.getEl(),H=B.getHeight(),G,C;if(!A.dd||!A.dd.constrain){return}if(typeof A.dd.dragEnded!=="undefined"&&!A.dd.dragEnded){return}C=H*(1-(D/100));G=A.getEl();G.setStyle({top:C})},setColor:function(E){var C=this,B=C.getDragContainer(),D,A;if(!C.getEl()){return}D=Ext.ux.colorpick.ColorUtils.rgb2hex(E.r,E.g,E.b);A=B.getEl().down(".x-autocontainer-innerCt");A.applyStyles(C.gradientStyleTpl.apply({hex:D,r:E.r,g:E.g,b:E.b}))}});Ext.define("Ext.ux.colorpick.SliderSaturation",{extend:"Ext.ux.colorpick.Slider",alias:"widget.colorpickerslidersaturation",cls:Ext.baseCSSPrefix+"colorpicker-saturation",gradientStyleTpl:Ext.create("Ext.XTemplate",Ext.isIE&&Ext.ieVersion<10?"filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr='#{hex}', endColorstr='#ffffff');":"background: -mox-linear-gradient(top, #{hex} 0%, #ffffff 100%);background: -webkit-linear-gradient(top, #{hex} 0%,#ffffff 100%);background: -o-linear-gradient(top, #{hex} 0%,#ffffff 100%);background: -ms-linear-gradient(top, #{hex} 0%,#ffffff 100%);background: linear-gradient(to bottom, #{hex} 0%,#ffffff 100%);"),setSaturation:function(B){var A=this,F=A.getDragContainer(),C=A.getDragHandle(),D=F.getEl(),H=D.getHeight(),G,E;if(!C.dd||!C.dd.constrain){return}if(typeof C.dd.dragEnded!=="undefined"&&!C.dd.dragEnded){return}G=1-(B/100);E=H*G;C.getEl().setStyle({top:E+"px"})},setHue:function(A){var C=this,E=C.getDragContainer(),B,D;if(!C.getEl()){return}B=Ext.ux.colorpick.ColorUtils.hsv2rgb(A,1,1);D=Ext.ux.colorpick.ColorUtils.rgb2hex(B.r,B.g,B.b);E.getEl().applyStyles(C.gradientStyleTpl.apply({hex:D}))}});Ext.define("Ext.ux.colorpick.SliderValue",{extend:"Ext.ux.colorpick.Slider",alias:"widget.colorpickerslidervalue",cls:Ext.baseCSSPrefix+"colorpicker-value",requires:["Ext.XTemplate"],gradientStyleTpl:Ext.create("Ext.XTemplate",Ext.isIE&&Ext.ieVersion<10?"filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0, startColorstr='#{hex}', endColorstr='#000000');":"background: -mox-linear-gradient(top, #{hex} 0%, #000000 100%);background: -webkit-linear-gradient(top, #{hex} 0%,#000000 100%);background: -o-linear-gradient(top, #{hex} 0%,#000000 100%);background: -ms-linear-gradient(top, #{hex} 0%,#000000 100%);background: linear-gradient(to bottom, #{hex} 0%,#000000 100%);"),setValue:function(D){var G=this,F=G.getDragContainer(),A=G.getDragHandle(),B=F.getEl(),H=B.getHeight(),E,C;if(!A.dd||!A.dd.constrain){return}if(typeof A.dd.dragEnded!=="undefined"&&!A.dd.dragEnded){return}E=1-(D/100);C=H*E;A.getEl().setStyle({top:C+"px"})},setHue:function(A){var C=this,E=C.getDragContainer(),B,D;if(!C.getEl()){return}B=Ext.ux.colorpick.ColorUtils.hsv2rgb(A,1,1);D=Ext.ux.colorpick.ColorUtils.rgb2hex(B.r,B.g,B.b);E.getEl().applyStyles(C.gradientStyleTpl.apply({hex:D}))}});Ext.define("Ext.ux.colorpick.SliderHue",{extend:"Ext.ux.colorpick.Slider",alias:"widget.colorpickersliderhue",cls:Ext.baseCSSPrefix+"colorpicker-hue",afterRender:function(){var B=this,C=B.gradientUrl,A=B.el;B.callParent();if(!C){C=A.getStyle("background-image");C=C.substring(4,C.length-1);if(C.indexOf('"')===0){C=C.substring(1,C.length-1)}Ext.ux.colorpick.SliderHue.prototype.gradientUrl=C}A.setStyle("background-image","none");A=B.getDragContainer().layout.getElementTarget();A.createChild({tag:"img",cls:Ext.baseCSSPrefix+"colorpicker-hue-gradient",src:C})},setHue:function(C){var F=this,E=F.getDragContainer(),A=F.getDragHandle(),B=E.getEl(),H=B.getHeight(),D,G;if(!A.dd||!A.dd.constrain){return}if(typeof A.dd.dragEnded!=="undefined"&&!A.dd.dragEnded){return}G=H*(360-C)/360;D=A.getEl();D.setStyle({top:G+"px"})}});Ext.define("Ext.ux.colorpick.Selector",{extend:"Ext.container.Container",xtype:"colorselector",mixins:["Ext.ux.colorpick.Selection"],controller:"colorpick-selectorcontroller",requires:["Ext.layout.container.HBox","Ext.form.field.Text","Ext.form.field.Number","Ext.ux.colorpick.ColorMap","Ext.ux.colorpick.SelectorModel","Ext.ux.colorpick.SelectorController","Ext.ux.colorpick.ColorPreview","Ext.ux.colorpick.Slider","Ext.ux.colorpick.SliderAlpha","Ext.ux.colorpick.SliderSaturation","Ext.ux.colorpick.SliderValue","Ext.ux.colorpick.SliderHue"],width:580,height:337,cls:Ext.baseCSSPrefix+"colorpicker",padding:10,layout:{type:"hbox",align:"stretch"},defaultBindProperty:"value",twoWayBindable:["value"],fieldWidth:50,fieldPad:5,showPreviousColor:false,showOkCancelButtons:false,listeners:{resize:"onResize"},constructor:function(B){var C=this,A=Ext.Factory.viewModel("colorpick-selectormodel");C.childViewModel=A;C.items=[C.getMapAndHexRGBFields(A),C.getSliderAndHField(A),C.getSliderAndSField(A),C.getSliderAndVField(A),C.getSliderAndAField(A),C.getPreviewAndButtons(A,B)];C.callParent(arguments)},updateColor:function(B){var A=this;A.mixins.colorselection.updateColor.call(A,B);A.childViewModel.set("selectedColor",B)},updatePreviousColor:function(A){this.childViewModel.set("previousColor",A)},getMapAndHexRGBFields:function(A){var B=this,D={top:0,right:B.fieldPad,bottom:0,left:0},C=B.fieldWidth;return{xtype:"container",viewModel:A,cls:Ext.baseCSSPrefix+"colorpicker-escape-overflow",flex:1,layout:{type:"vbox",align:"stretch"},margin:"0 10 0 0",items:[{xtype:"colorpickercolormap",reference:"colorMap",flex:1,bind:{position:{bindTo:"{selectedColor}",deep:true},hue:"{selectedColor.h}"},listeners:{handledrag:"onColorMapHandleDrag"}},{xtype:"container",layout:"hbox",defaults:{labelAlign:"top",labelSeparator:"",allowBlank:false,onChange:function(){if(this.isValid()){Ext.form.field.Base.prototype.onChange.apply(this,arguments)}}},items:[{xtype:"textfield",fieldLabel:"HEX",flex:1,bind:"{hex}",margin:D,readOnly:true},{xtype:"numberfield",fieldLabel:"R",bind:"{red}",width:C,hideTrigger:true,maxValue:255,minValue:0,margin:D},{xtype:"numberfield",fieldLabel:"G",bind:"{green}",width:C,hideTrigger:true,maxValue:255,minValue:0,margin:D},{xtype:"numberfield",fieldLabel:"B",bind:"{blue}",width:C,hideTrigger:true,maxValue:255,minValue:0,margin:0}]}]}},getSliderAndHField:function(A){var B=this;return{xtype:"container",viewModel:A,cls:Ext.baseCSSPrefix+"colorpicker-escape-overflow",width:B.fieldWidth,layout:{type:"vbox",align:"stretch"},items:[{xtype:"colorpickersliderhue",reference:"hueSlider",flex:1,bind:{hue:"{selectedColor.h}"},listeners:{handledrag:"onHueSliderHandleDrag"}},{xtype:"numberfield",fieldLabel:"H",labelAlign:"top",width:B.fieldWidth,labelSeparator:"",bind:"{hue}",hideTrigger:true,maxValue:360,minValue:0,allowBlank:false,margin:0}]}},getSliderAndSField:function(A){var B=this;return{xtype:"container",viewModel:A,cls:Ext.baseCSSPrefix+"colorpicker-escape-overflow",width:B.fieldWidth,layout:{type:"vbox",align:"stretch"},margin:{right:B.fieldPad,left:B.fieldPad},items:[{xtype:"colorpickerslidersaturation",reference:"satSlider",flex:1,bind:{saturation:"{saturation}",hue:"{selectedColor.h}"},listeners:{handledrag:"onSaturationSliderHandleDrag"}},{xtype:"numberfield",fieldLabel:"S",labelAlign:"top",labelSeparator:"",bind:"{saturation}",hideTrigger:true,maxValue:100,minValue:0,allowBlank:false,margin:0}]}},getSliderAndVField:function(A){var B=this;return{xtype:"container",viewModel:A,cls:Ext.baseCSSPrefix+"colorpicker-escape-overflow",width:B.fieldWidth,layout:{type:"vbox",align:"stretch"},items:[{xtype:"colorpickerslidervalue",reference:"valueSlider",flex:1,bind:{value:"{value}",hue:"{selectedColor.h}"},listeners:{handledrag:"onValueSliderHandleDrag"}},{xtype:"numberfield",fieldLabel:"V",labelAlign:"top",labelSeparator:"",bind:"{value}",hideTrigger:true,maxValue:100,minValue:0,allowBlank:false,margin:0}]}},getSliderAndAField:function(A){var B=this;return{xtype:"container",viewModel:A,cls:Ext.baseCSSPrefix+"colorpicker-escape-overflow",width:B.fieldWidth,layout:{type:"vbox",align:"stretch"},margin:{left:B.fieldPad},items:[{xtype:"colorpickerslideralpha",reference:"alphaSlider",flex:1,bind:{alpha:"{alpha}",color:{bindTo:"{selectedColor}",deep:true}},listeners:{handledrag:"onAlphaSliderHandleDrag"}},{xtype:"numberfield",fieldLabel:"A",labelAlign:"top",labelSeparator:"",bind:"{alpha}",hideTrigger:true,maxValue:100,minValue:0,allowBlank:false,margin:0}]}},getPreviewAndButtons:function(A,B){var C=[{xtype:"colorpickercolorpreview",flex:1,bind:{color:{bindTo:"{selectedColor}",deep:true}}}];if(B.showPreviousColor){C.push({xtype:"colorpickercolorpreview",flex:1,bind:{color:{bindTo:"{previousColor}",deep:true}},listeners:{click:"onPreviousColorSelected"}})}if(B.showOkCancelButtons){C.push({xtype:"button",text:"OK",margin:"10 0 0 0",handler:"onOK"},{xtype:"button",text:"Cancel",margin:"10 0 0 0",handler:"onCancel"})}return{xtype:"container",viewModel:A,width:70,margin:"0 0 0 10",items:C,layout:{type:"vbox",align:"stretch"}}}});Ext.define("Ext.ux.colorpick.ButtonController",{extend:"Ext.app.ViewController",alias:"controller.colorpick-buttoncontroller",requires:["Ext.window.Window","Ext.layout.container.Fit","Ext.ux.colorpick.Selector","Ext.ux.colorpick.ColorUtils"],afterRender:function(A){A.updateColor(A.getColor())},destroy:function(){var A=this.getView(),B=A.colorPickerWindow;if(B){B.destroy();A.colorPickerWindow=A.colorPicker=null}this.callParent()},getPopup:function(){var B=this.getView(),C=B.colorPickerWindow,A;if(!C){C=Ext.create(B.getPopup());B.colorPickerWindow=C;C.colorPicker=B.colorPicker=A=C.lookupReference("selector");A.setFormat(B.getFormat());A.on({ok:"onColorPickerOK",cancel:"onColorPickerCancel",scope:this});C.on({close:"onColorPickerCancel",scope:this})}return C},onClick:function(){var B=this,D=B.getView(),E=D.getColor(),C=B.getPopup(),A=C.colorPicker;A.setColor(E);A.setPreviousColor(E);C.showBy(D,"tl-br?")},onColorPickerOK:function(C){var B=this.getView(),D=C.getColor(),A=B.colorPickerWindow;A.hide();B.setColor(D)},onColorPickerCancel:function(){var B=this.getView(),A=B.colorPickerWindow;A.hide()},syncColor:function(B){var A=this.getView();Ext.ux.colorpick.ColorUtils.setBackground(A.filterEl,B)}});Ext.define("Ext.ux.colorpick.Button",{extend:"Ext.Component",xtype:"colorbutton",controller:"colorpick-buttoncontroller",mixins:["Ext.ux.colorpick.Selection"],requires:["Ext.ux.colorpick.ButtonController"],baseCls:Ext.baseCSSPrefix+"colorpicker-button",width:20,height:20,childEls:["btnEl","filterEl"],config:{popup:{lazy:true,$value:{xtype:"window",closeAction:"hide",referenceHolder:true,minWidth:540,minHeight:200,layout:"fit",header:false,resizable:true,items:{xtype:"colorselector",reference:"selector",showPreviousColor:true,showOkCancelButtons:true}}}},defaultBindProperty:"value",twoWayBindable:"value",renderTpl:'<div id="{id}-filterEl" data-ref="filterEl" style="height:100%; width:100%; position: absolute;"></div><a id="{id}-btnEl" data-ref="btnEl" style="height:100%; width:100%; position: absolute;"></a>',listeners:{click:"onClick",element:"btnEl"},updateColor:function(C){var A=this,B=A.colorPicker;A.mixins.colorselection.updateColor.call(A,C);Ext.ux.colorpick.ColorUtils.setBackground(A.filterEl,C);if(B){B.setColor(C)}},updateFormat:function(A){var B=this.colorPicker;if(B){B.setFormat(A)}}});Ext.define("Ext.ux.colorpick.Field",{extend:"Ext.form.field.Picker",xtype:"colorfield",mixins:["Ext.ux.colorpick.Selection"],requires:["Ext.window.Window","Ext.ux.colorpick.Selector","Ext.ux.colorpick.ColorUtils","Ext.layout.container.Fit"],editable:false,matchFieldWidth:false,beforeBodyEl:['<div class="'+Ext.baseCSSPrefix+'colorpicker-field-swatch"><div id="{id}-swatchEl" data-ref="swatchEl" class="'+Ext.baseCSSPrefix+'colorpicker-field-swatch-inner"></div></div>'],cls:Ext.baseCSSPrefix+"colorpicker-field",childEls:["swatchEl"],config:{popup:{lazy:true,$value:{xtype:"window",closeAction:"hide",referenceHolder:true,minWidth:540,minHeight:200,layout:"fit",header:false,resizable:true,items:{xtype:"colorselector",reference:"selector",showPreviousColor:true,showOkCancelButtons:true}}}},afterRender:function(){this.callParent();this.updateValue(this.value)},createPicker:function(){var A=this,C=A.getPopup(),B;A.colorPickerWindow=C=Ext.create(C);A.colorPicker=B=C.lookupReference("selector");B.setFormat(A.getFormat());B.setColor(A.getColor());B.on({ok:"onColorPickerOK",cancel:"onColorPickerCancel",scope:A});C.on({close:"onColorPickerCancel",scope:A});return A.colorPickerWindow},onColorPickerOK:function(A){this.setColor(A.getColor());this.collapse()},onColorPickerCancel:function(){this.collapse()},onExpand:function(){var A=this.getColor();this.colorPicker.setPreviousColor(A)},setValue:function(C){var A=this,B=A.applyValue(C);A.callParent([B]);A.updateValue(B)},updateFormat:function(A){var B=this.colorPicker;if(B){B.setFormat(A)}},updateValue:function(C){var A=this,B;if(!A.syncing){A.syncing=true;A.setColor(C);A.syncing=false}B=A.getColor();Ext.ux.colorpick.ColorUtils.setBackground(A.swatchEl,B);if(A.colorPicker){A.colorPicker.setColor(B)}}});Ext.define("Ext.ux.data.PagingMemoryProxy",{extend:"Ext.data.proxy.Memory",alias:"proxy.pagingmemory",alternateClassName:"Ext.data.PagingMemoryProxy",constructor:function(){Ext.log.warn("Ext.ux.data.PagingMemoryProxy functionality has been merged into Ext.data.proxy.Memory by using the enablePaging flag.");this.callParent(arguments)},read:function(F,B,C){var G=this.getReader(),A=G.read(this.data),H,I,D,E;C=C||this;I=F.filters;if(I.length>0){E=[];Ext.each(A.records,function(M){var N=true,J=I.length,K;for(K=0;K<J;K++){var P=I[K],L=P.filterFn,O=P.scope;N=N&&L.call(O,M)}if(N){E.push(M)}},this);A.records=E;A.totalRecords=A.total=E.length}H=F.sorters;if(H.length>0){D=function(L,M){var N=H[0].sort(L,M),J=H.length,K;for(K=1;K<J;K++){N=N||H[K].sort.call(this,L,M)}return N};A.records.sort(D)}if(F.start!==undefined&&F.limit!==undefined){A.records=A.records.slice(F.start,F.start+F.limit);A.count=A.records.length}Ext.apply(F,{resultSet:A});F.setCompleted();F.setSuccessful();Ext.Function.defer(function(){Ext.callback(B,C,[F])},10)}});Ext.define("Ext.ux.dd.CellFieldDropZone",{extend:"Ext.dd.DropZone",constructor:function(A){A=A||{};if(A.onCellDrop){this.onCellDrop=A.onCellDrop}if(A.ddGroup){this.ddGroup=A.ddGroup}},init:function(B){var A=this;if(B.rendered){A.grid=B;B.getView().on({render:function(C){A.view=C;Ext.ux.dd.CellFieldDropZone.superclass.constructor.call(A,A.view.el)},single:true})}else{B.on("render",A.init,A,{single:true})}},containerScroll:true,getTargetFromEvent:function(A){var C=this,D=C.view;var E=A.getTarget(D.getCellSelector());if(E){var B=D.findItemByChild(E),F=E.cellIndex;if(B&&Ext.isDefined(F)){return{node:E,record:D.getRecord(B),fieldName:C.grid.getVisibleColumnManager().getColumns()[F].dataIndex}}}},onNodeEnter:function(E,F,B,A){delete this.dropOK;if(!E){return}var C=A.field;if(!C){return}var D=E.record.fieldsMap[E.fieldName];if(D.isNumeric){if(!C.isXType("numberfield")){return}}else{if(D.isDateField){if(!C.isXType("datefield")){return}}else{if(D.isBooleanField){if(!C.isXType("checkbox")){return}}}}this.dropOK=true;Ext.fly(E.node).addCls("x-drop-target-active")},onNodeOver:function(C,D,B,A){return this.dropOK?this.dropAllowed:this.dropNotAllowed},onNodeOut:function(C,D,B,A){Ext.fly(C.node).removeCls("x-drop-target-active")},onNodeDrop:function(D,E,B,A){if(this.dropOK){var C=A.field.getValue();D.record.set(D.fieldName,C);this.onCellDrop(D.fieldName,C);return true}},onCellDrop:Ext.emptyFn});Ext.define("Ext.ux.dd.PanelFieldDragZone",{extend:"Ext.dd.DragZone",constructor:function(A){A=A||{};if(A.ddGroup){this.ddGroup=A.ddGroup}},init:function(A){if(A.nodeType){Ext.ux.dd.PanelFieldDragZone.superclass.init.apply(this,arguments)}else{if(A.rendered){Ext.ux.dd.PanelFieldDragZone.superclass.constructor.call(this,A.getEl())}else{A.on("afterrender",this.init,this,{single:true})}}},scroll:false,getDragData:function(B){var A=B.getTarget("label",null,true),C,D,E,F;if(A){E=Ext.getCmp(A.up("."+Ext.form.Labelable.prototype.formItemCls).id);D=E.preventMark;E.preventMark=true;if(E.isValid()){E.preventMark=D;F=document.createElement("div");F.className=Ext.baseCSSPrefix+"form-text";C=E.getRawValue();F.innerHTML=Ext.isEmpty(C)?"&#160;":C;Ext.fly(F).setWidth(E.getEl().getWidth());return{field:E,ddel:F}}else{B.stopEvent()}E.preventMark=D}},getRepairXY:function(){return this.dragData.field.getEl().getXY()}});
/*
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.Desktop",{extend:"Ext.panel.Panel",alias:"widget.desktop",uses:["Ext.util.MixedCollection","Ext.menu.Menu","Ext.view.View","Ext.window.Window","Ext.ux.desktop.TaskBar","Ext.ux.desktop.Wallpaper"],activeWindowCls:"ux-desktop-active-win",inactiveWindowCls:"ux-desktop-inactive-win",lastActiveWindow:null,border:false,html:"&#160;",layout:"fit",xTickSize:1,yTickSize:1,app:null,shortcuts:null,shortcutItemSelector:"div.ux-desktop-shortcut",shortcutTpl:['<tpl for=".">','<div class="ux-desktop-shortcut" id="{name}-shortcut">','<div class="ux-desktop-shortcut-icon {iconCls}">','<img src="',Ext.BLANK_IMAGE_URL,'" title="{name}">',"</div>",'<span class="ux-desktop-shortcut-text">{name}</span>',"</div>","</tpl>",'<div class="x-clear"></div>'],taskbarConfig:null,windowMenu:null,initComponent:function(){var B=this;B.windowMenu=new Ext.menu.Menu(B.createWindowMenu());B.bbar=B.taskbar=new Ext.ux.desktop.TaskBar(B.taskbarConfig);B.taskbar.windowMenu=B.windowMenu;B.windows=new Ext.util.MixedCollection();B.contextMenu=new Ext.menu.Menu(B.createDesktopMenu());B.items=[{xtype:"wallpaper",id:B.id+"_wallpaper"},B.createDataView()];B.callParent();B.shortcutsView=B.items.getAt(1);B.shortcutsView.on("itemclick",B.onShortcutItemClick,B);var A=B.wallpaper;B.wallpaper=B.items.getAt(0);if(A){B.setWallpaper(A,B.wallpaperStretch)}},afterRender:function(){var A=this;A.callParent();A.el.on("contextmenu",A.onDesktopMenu,A)},createDataView:function(){var A=this;return{xtype:"dataview",overItemCls:"x-view-over",trackOver:true,itemSelector:A.shortcutItemSelector,store:A.shortcuts,style:{position:"absolute"},x:0,y:0,tpl:new Ext.XTemplate(A.shortcutTpl)}},createDesktopMenu:function(){var A=this,B={items:A.contextMenuItems||[]};if(B.items.length){B.items.push("-")}B.items.push({text:"Tile",handler:A.tileWindows,scope:A,minWindows:1},{text:"Cascade",handler:A.cascadeWindows,scope:A,minWindows:1});return B},createWindowMenu:function(){var A=this;return{defaultAlign:"br-tr",items:[{text:"Restore",handler:A.onWindowMenuRestore,scope:A},{text:"Minimize",handler:A.onWindowMenuMinimize,scope:A},{text:"Maximize",handler:A.onWindowMenuMaximize,scope:A},"-",{text:"Close",handler:A.onWindowMenuClose,scope:A}],listeners:{beforeshow:A.onWindowMenuBeforeShow,hide:A.onWindowMenuHide,scope:A}}},onDesktopMenu:function(A){var B=this,C=B.contextMenu;A.stopEvent();if(!C.rendered){C.on("beforeshow",B.onDesktopMenuBeforeShow,B)}C.showAt(A.getXY());C.doConstrain()},onDesktopMenuBeforeShow:function(C){var B=this,A=B.windows.getCount();C.items.each(function(E){var D=E.minWindows||0;E.setDisabled(A<D)})},onShortcutItemClick:function(D,E){var B=this,A=B.app.getModule(E.data.module),C=A&&A.createWindow();if(C){B.restoreWindow(C)}},onWindowClose:function(A){var B=this;B.windows.remove(A);B.taskbar.removeTaskButton(A.taskButton);B.updateActiveWindow()},onWindowMenuBeforeShow:function(C){var B=C.items.items,A=C.theWin;B[0].setDisabled(A.maximized!==true&&A.hidden!==true);B[1].setDisabled(A.minimized===true);B[2].setDisabled(A.maximized===true||A.hidden===true)},onWindowMenuClose:function(){var B=this,A=B.windowMenu.theWin;A.close()},onWindowMenuHide:function(A){Ext.defer(function(){A.theWin=null},1)},onWindowMenuMaximize:function(){var B=this,A=B.windowMenu.theWin;A.maximize();A.toFront()},onWindowMenuMinimize:function(){var B=this,A=B.windowMenu.theWin;A.minimize()},onWindowMenuRestore:function(){var B=this,A=B.windowMenu.theWin;B.restoreWindow(A)},getWallpaper:function(){return this.wallpaper.wallpaper},setTickSize:function(A,B){var C=this,D=C.xTickSize=A,E=C.yTickSize=(arguments.length>1)?B:D;C.windows.each(function(F){var H=F.dd,G=F.resizer;H.xTickSize=D;H.yTickSize=E;G.widthIncrement=D;G.heightIncrement=E})},setWallpaper:function(A,B){this.wallpaper.setWallpaper(A,B);return this},cascadeWindows:function(){var B=0,C=0,A=this.getDesktopZIndexManager();A.eachBottomUp(function(D){if(D.isWindow&&D.isVisible()&&!D.maximized){D.setPosition(B,C);B+=20;C+=20}})},createWindow:function(B,D){var C=this,A,E=Ext.applyIf(B||{},{stateful:false,isWindow:true,constrainHeader:true,minimizable:true,maximizable:true});D=D||Ext.window.Window;A=C.add(new D(E));C.windows.add(A);A.taskButton=C.taskbar.addTaskButton(A);A.animateTarget=A.taskButton.el;A.on({activate:C.updateActiveWindow,beforeshow:C.updateActiveWindow,deactivate:C.updateActiveWindow,minimize:C.minimizeWindow,destroy:C.onWindowClose,scope:C});A.on({boxready:function(){A.dd.xTickSize=C.xTickSize;A.dd.yTickSize=C.yTickSize;if(A.resizer){A.resizer.widthIncrement=C.xTickSize;A.resizer.heightIncrement=C.yTickSize}},single:true});A.doClose=function(){A.doClose=Ext.emptyFn;A.el.disableShadow();A.el.fadeOut({listeners:{afteranimate:function(){A.destroy()}}})};return A},getActiveWindow:function(){var B=null,A=this.getDesktopZIndexManager();if(A){A.eachTopDown(function(C){if(C.isWindow&&!C.hidden){B=C;return false}return true})}return B},getDesktopZIndexManager:function(){var A=this.windows;return(A.getCount()&&A.getAt(0).zIndexManager)||null},getWindow:function(A){return this.windows.get(A)},minimizeWindow:function(A){A.minimized=true;A.hide()},restoreWindow:function(A){if(A.isVisible()){A.restore();A.toFront()}else{A.show()}return A},tileWindows:function(){var B=this,E=B.body.getWidth(true);var C=B.xTickSize,D=B.yTickSize,A=D;B.windows.each(function(F){if(F.isVisible()&&!F.maximized){var G=F.el.getWidth();if(C>B.xTickSize&&C+G>E){C=B.xTickSize;D=A}F.setPosition(C,D);C+=G+B.xTickSize;A=Math.max(A,D+F.el.getHeight()+B.yTickSize)}})},updateActiveWindow:function(){var B=this,A=B.getActiveWindow(),C=B.lastActiveWindow;if(C&&C.destroyed){B.lastActiveWindow=null;return}if(A===C){return}if(C){if(C.el.dom){C.addCls(B.inactiveWindowCls);C.removeCls(B.activeWindowCls)}C.active=false}B.lastActiveWindow=A;if(A){A.addCls(B.activeWindowCls);A.removeCls(B.inactiveWindowCls);A.minimized=false;A.active=true}B.taskbar.setActiveButton(A&&A.taskButton)}});Ext.define("Ext.ux.desktop.App",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.container.Viewport","Ext.ux.desktop.Desktop"],isReady:false,modules:null,useQuickTips:true,constructor:function(A){var B=this;B.mixins.observable.constructor.call(this,A);if(Ext.isReady){Ext.Function.defer(B.init,10,B)}else{Ext.onReady(B.init,B)}},init:function(){var B=this,A;if(B.useQuickTips){Ext.QuickTips.init()}B.modules=B.getModules();if(B.modules){B.initModules(B.modules)}A=B.getDesktopConfig();B.desktop=new Ext.ux.desktop.Desktop(A);B.viewport=new Ext.container.Viewport({layout:"fit",items:[B.desktop]});Ext.getWin().on("beforeunload",B.onUnload,B);B.isReady=true;B.fireEvent("ready",B)},getDesktopConfig:function(){var A=this,B={app:A,taskbarConfig:A.getTaskbarConfig()};Ext.apply(B,A.desktopConfig);return B},getModules:Ext.emptyFn,getStartConfig:function(){var A=this,C={app:A,menu:[]},B;Ext.apply(C,A.startConfig);Ext.each(A.modules,function(D){B=D.launcher;if(B){B.handler=B.handler||Ext.bind(A.createWindow,A,[D]);C.menu.push(D.launcher)}});return C},createWindow:function(B){var A=B.createWindow();A.show()},getTaskbarConfig:function(){var A=this,B={app:A,startConfig:A.getStartConfig()};Ext.apply(B,A.taskbarConfig);return B},initModules:function(A){var B=this;Ext.each(A,function(C){C.app=B})},getModule:function(C){var B=this.modules;for(var A=0,D=B.length;A<D;A++){var E=B[A];if(E.id==C||E.appType==C){return E}}return null},onReady:function(A,B){if(this.isReady){A.call(B,this)}else{this.on({ready:A,scope:B,single:true})}},getDesktop:function(){return this.desktop},onUnload:function(A){if(this.fireEvent("beforeunload",this)===false){A.stopEvent()}}});
/*
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.Module",{mixins:{observable:"Ext.util.Observable"},constructor:function(A){this.mixins.observable.constructor.call(this,A);this.init()},init:Ext.emptyFn});
/*
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.ShortcutModel",{extend:"Ext.data.Model",fields:[{name:"name"},{name:"iconCls"},{name:"module"}]});Ext.define("Ext.ux.desktop.StartMenu",{extend:"Ext.menu.Menu",baseCls:Ext.baseCSSPrefix+"panel",cls:"x-menu ux-start-menu",bodyCls:"ux-start-menu-body",defaultAlign:"bl-tl",iconCls:"user",bodyBorder:true,width:300,initComponent:function(){var A=this;A.layout.align="stretch";A.items=A.menu;A.callParent();A.toolbar=new Ext.toolbar.Toolbar(Ext.apply({dock:"right",cls:"ux-start-menu-toolbar",vertical:true,width:100,layout:{align:"stretch"}},A.toolConfig));A.addDocked(A.toolbar);delete A.toolItems},addMenuItem:function(){var A=this.menu;A.add.apply(A,arguments)},addToolItem:function(){var A=this.toolbar;A.add.apply(A,arguments)}});
/*
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.TaskBar",{extend:"Ext.toolbar.Toolbar",requires:["Ext.button.Button","Ext.resizer.Splitter","Ext.menu.Menu","Ext.ux.desktop.StartMenu"],alias:"widget.taskbar",cls:"ux-taskbar",startBtnText:"Start",initComponent:function(){var A=this;A.startMenu=new Ext.ux.desktop.StartMenu(A.startConfig);A.quickStart=new Ext.toolbar.Toolbar(A.getQuickStart());A.windowBar=new Ext.toolbar.Toolbar(A.getWindowBarConfig());A.tray=new Ext.toolbar.Toolbar(A.getTrayConfig());A.items=[{xtype:"button",cls:"ux-start-button",iconCls:"ux-start-button-icon",menu:A.startMenu,menuAlign:"bl-tl",text:A.startBtnText},A.quickStart,{xtype:"splitter",html:"&#160;",height:14,width:2,cls:"x-toolbar-separator x-toolbar-separator-horizontal"},A.windowBar,"-",A.tray];A.callParent()},afterLayout:function(){var A=this;A.callParent();A.windowBar.el.on("contextmenu",A.onButtonContextMenu,A)},getQuickStart:function(){var A=this,B={minWidth:20,width:Ext.themeName==="neptune"?70:60,items:[],enableOverflow:true};Ext.each(this.quickStart,function(C){B.items.push({tooltip:{text:C.name,align:"bl-tl"},overflowText:C.name,iconCls:C.iconCls,module:C.module,handler:A.onQuickStartClick,scope:A})});return B},getTrayConfig:function(){var A={items:this.trayItems};delete this.trayItems;return A},getWindowBarConfig:function(){return{flex:1,cls:"ux-desktop-windowbar",items:["&#160;"],layout:{overflowHandler:"Scroller"}}},getWindowBtnFromEl:function(A){var B=this.windowBar.getChildByElement(A);return B||null},onQuickStartClick:function(C){var B=this.app.getModule(C.module),A;if(B){A=B.createWindow();A.show()}},onButtonContextMenu:function(A){var B=this,D=A.getTarget(),C=B.getWindowBtnFromEl(D);if(C){A.stopEvent();B.windowMenu.theWin=C.win;B.windowMenu.showBy(D)}},onWindowBtnClick:function(B){var A=B.win;if(A.minimized||A.hidden){B.disable();A.show(null,function(){B.enable()})}else{if(A.active){B.disable();A.on("hide",function(){B.enable()},null,{single:true});A.minimize()}else{A.toFront()}}},addTaskButton:function(A){var B={iconCls:A.iconCls,enableToggle:true,toggleGroup:"all",width:140,margin:"0 2 0 3",text:Ext.util.Format.ellipsis(A.title,20),listeners:{click:this.onWindowBtnClick,scope:this},win:A};var C=this.windowBar.add(B);C.toggle(true);return C},removeTaskButton:function(B){var C,A=this;A.windowBar.items.each(function(D){if(D===B){C=D}return !C});if(C){A.windowBar.remove(C)}return C},setActiveButton:function(A){if(A){A.toggle(true)}else{this.windowBar.items.each(function(B){if(B.isButton){B.toggle(false)}})}}});Ext.define("Ext.ux.desktop.TrayClock",{extend:"Ext.toolbar.TextItem",alias:"widget.trayclock",cls:"ux-desktop-trayclock",html:"&#160;",timeFormat:"g:i A",tpl:"{time}",initComponent:function(){var A=this;A.callParent();if(typeof(A.tpl)=="string"){A.tpl=new Ext.XTemplate(A.tpl)}},afterRender:function(){var A=this;Ext.Function.defer(A.updateTime,100,A);A.callParent()},onDestroy:function(){var A=this;if(A.timer){window.clearTimeout(A.timer);A.timer=null}A.callParent()},updateTime:function(){var A=this,B=Ext.Date.format(new Date(),A.timeFormat),C=A.tpl.apply({time:B});if(A.lastText!=C){A.setText(C);A.lastText=C}A.timer=Ext.Function.defer(A.updateTime,10000,A)}});
/*
* Ext JS Library
* Copyright(c) 2006-2015 Sencha Inc.
* licensing@sencha.com
* http://www.sencha.com/license
*/
Ext.define("Ext.ux.desktop.Video",{extend:"Ext.panel.Panel",alias:"widget.video",layout:"fit",autoplay:false,controls:true,bodyStyle:"background-color:#000;color:#fff",html:"",tpl:['<video id="{id}-video" autoPlay="{autoplay}" controls="{controls}" poster="{poster}" start="{start}" loopstart="{loopstart}" loopend="{loopend}" autobuffer="{autobuffer}" loop="{loop}" style="width:100%;height:100%">','<tpl for="src">','<source src="{src}" type="{type}"/>',"</tpl>","{html}","</video>"],initComponent:function(){var D=this,A,C,F,E;if(D.fallbackHTML){A=D.fallbackHTML}else{A="Your browser does not support HTML5 Video. ";if(Ext.isChrome){A+="Upgrade Chrome."}else{if(Ext.isGecko){A+="Upgrade to Firefox 3.5 or newer."}else{var B='<a href="http://www.google.com/chrome">Chrome</a>';A+='Please try <a href="http://www.mozilla.com">Firefox</a>';if(Ext.isIE){A+=", "+B+' or <a href="http://www.apple.com/safari/">Safari</a>.'}else{A+=" or "+B+"."}}}}D.fallbackHTML=A;F=D.data=Ext.copyTo({tag:"video",html:A},D,"id,poster,start,loopstart,loopend,playcount,autobuffer,loop");if(D.autoplay){F.autoplay=1}if(D.controls){F.controls=1}if(Ext.isArray(D.src)){F.src=D.src}else{F.src=[{src:D.src}]}D.callParent()},afterRender:function(){var A=this;A.callParent();A.video=A.body.getById(A.id+"-video");el=A.video.dom;A.supported=(el&&el.tagName.toLowerCase()=="video");if(A.supported){A.video.on("error",A.onVideoError,A)}},getFallback:function(){return'<h1 style="background-color:#ff4f4f;padding: 10px;">'+this.fallbackHTML+"</h1>"},onVideoError:function(){var A=this;A.video.remove();A.supported=false;A.body.createChild(A.getFallback())},onDestroy:function(){var A=this;var C=A.video;if(A.supported&&C){var B=C.dom;if(B&&B.pause){B.pause()}C.remove();A.video=null}A.callParent()}});
/*
 * Ext JS Library
 * Copyright(c) 2006-2014 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.desktop.Wallpaper",{extend:"Ext.Component",alias:"widget.wallpaper",cls:"ux-wallpaper",html:'<img src="'+Ext.BLANK_IMAGE_URL+'">',stretch:false,wallpaper:null,stateful:true,stateId:"desk-wallpaper",afterRender:function(){var A=this;A.callParent();A.setWallpaper(A.wallpaper,A.stretch)},applyState:function(){var B=this,A=B.wallpaper;B.callParent(arguments);if(A!=B.wallpaper){B.setWallpaper(B.wallpaper)}},getState:function(){return this.wallpaper&&{wallpaper:this.wallpaper}},setWallpaper:function(B,E){var C=this,A,D;C.stretch=(E!==false);C.wallpaper=B;if(C.rendered){A=C.el.dom.firstChild;if(!B||B==Ext.BLANK_IMAGE_URL){Ext.fly(A).hide()}else{if(C.stretch){A.src=B;C.el.removeCls("ux-wallpaper-tiled");Ext.fly(A).setStyle({width:"100%",height:"100%"}).show()}else{Ext.fly(A).hide();D="url("+B+")";C.el.addCls("ux-wallpaper-tiled")}}C.el.setStyle({backgroundImage:D||""});if(C.stateful){C.saveState()}}return C}});Ext.define("Ext.ux.event.RecorderManager",{extend:"Ext.panel.Panel",alias:"widget.eventrecordermanager",uses:["Ext.ux.event.Recorder","Ext.ux.event.Player"],layout:"fit",buttonAlign:"left",eventsToIgnore:{mousemove:1,mouseover:1,mouseout:1},bodyBorder:false,playSpeed:1,initComponent:function(){var B=this;B.recorder=new Ext.ux.event.Recorder({attachTo:B.attachTo,listeners:{add:B.updateEvents,coalesce:B.updateEvents,buffer:200,scope:B}});B.recorder.eventsToRecord=Ext.apply({},B.recorder.eventsToRecord);function A(D,E){return{text:D,speed:E,group:"speed",checked:E==B.playSpeed,handler:B.onPlaySpeed,scope:B}}B.tbar=[{text:"Record",xtype:"splitbutton",whenIdle:true,handler:B.onRecord,scope:B,menu:B.makeRecordButtonMenu()},{text:"Play",xtype:"splitbutton",whenIdle:true,handler:B.onPlay,scope:B,menu:[A("Qarter Speed (0.25x)",0.25),A("Half Speed (0.5x)",0.5),A("3/4 Speed (0.75x)",0.75),"-",A("Recorded Speed (1x)",1),A("Double Speed (2x)",2),A("Quad Speed (4x)",4),"-",A("Full Speed",1000)]},{text:"Clear",whenIdle:true,handler:B.onClear,scope:B},"->",{text:"Stop",whenActive:true,disabled:true,handler:B.onStop,scope:B}];var C=B.attachTo&&B.attachTo.testEvents;B.items=[{xtype:"textarea",itemId:"eventView",fieldStyle:"font-family: monospace",selectOnFocus:true,emptyText:"Events go here!",value:C?B.stringifyEvents(C):"",scrollToBottom:function(){var D=this.inputEl.dom;D.scrollTop=D.scrollHeight}}];B.fbar=[{xtype:"tbtext",text:"Attached To: "+(B.attachTo&&B.attachTo.location.href)}];B.callParent()},makeRecordButtonMenu:function(){var D=[],A={},C=this.recorder.eventsToRecord,E=this.eventsToIgnore;Ext.Object.each(C,function(G,H){var F=A[H.kind];if(!F){A[H.kind]=F=[];D.push({text:H.kind,menu:F})}F.push({text:G,checked:true,handler:function(I){if(I.checked){C[G]=H}else{delete C[G]}}});if(E[G]){F[F.length-1].checked=false;Ext.Function.defer(function(){delete C[G]},1)}});function B(G,F){return(G.text<F.text)?-1:((F.text<G.text)?1:0)}D.sort(B);Ext.Array.each(D,function(F){F.menu.sort(B)});return D},getEventView:function(){return this.down("#eventView")},onClear:function(){var A=this.getEventView();A.setValue("")},onPlay:function(){var A=this,C=A.getEventView(),B=C.getValue();if(B){B=Ext.decode(B);if(B.length){A.player=Ext.create("Ext.ux.event.Player",{attachTo:window.opener,eventQueue:B,speed:A.playSpeed,listeners:{stop:A.onPlayStop,scope:A}});A.player.start();A.syncBtnUI()}}},onPlayStop:function(){this.player=null;this.syncBtnUI()},onPlaySpeed:function(A){this.playSpeed=A.speed},onRecord:function(){this.recorder.start();this.syncBtnUI()},onStop:function(){var A=this;if(A.player){A.player.stop();A.player=null}else{A.recorder.stop()}A.syncBtnUI();A.updateEvents()},syncBtnUI:function(){var B=this,A=!B.player&&!B.recorder.active;Ext.each(B.query("[whenIdle]"),function(D){D.setDisabled(!A)});Ext.each(B.query("[whenActive]"),function(D){D.setDisabled(A)});var C=B.getEventView();C.setReadOnly(!A)},stringifyEvents:function(B){var C,A=[];Ext.each(B,function(D){C=[];Ext.Object.each(D,function(E,F){if(C.length){C.push(", ")}else{C.push("  { ")}C.push(E,": ");C.push(Ext.encode(F))});C.push(" }");A.push(C.join(""))});return"[\n"+A.join(",\n")+"\n]"},updateEvents:function(){var B=this,C=B.stringifyEvents(B.recorder.getRecordedEvents()),A=B.getEventView();A.setValue(C);A.scrollToBottom()}});Ext.define("Ext.ux.form.MultiSelect",{extend:"Ext.form.FieldContainer",mixins:["Ext.util.StoreHolder","Ext.form.field.Field"],alternateClassName:"Ext.ux.Multiselect",alias:["widget.multiselectfield","widget.multiselect"],requires:["Ext.panel.Panel","Ext.view.BoundList","Ext.layout.container.Fit"],uses:["Ext.view.DragZone","Ext.view.DropZone"],layout:"anchor",ddReorder:false,appendOnly:false,displayField:"text",allowBlank:true,minSelections:0,maxSelections:Number.MAX_VALUE,blankText:"This field is required",minSelectionsText:"Minimum {0} item(s) required",maxSelectionsText:"Maximum {0} item(s) required",delimiter:",",dragText:"{0} Item{1}",ignoreSelectChange:0,pageSize:10,initComponent:function(){var A=this;A.items=A.setupItems();A.bindStore(A.store,true);if(A.store.autoCreated){A.valueField=A.displayField="field1";if(!A.store.expanded){A.displayField="field2"}}if(!Ext.isDefined(A.valueField)){A.valueField=A.displayField}A.callParent();A.initField()},setupItems:function(){var A=this;A.boundList=new Ext.view.BoundList(Ext.apply({anchor:"none 100%",border:1,multiSelect:true,store:A.store,displayField:A.displayField,disabled:A.disabled,tabIndex:0,navigationModel:{type:"default"}},A.listConfig));A.boundList.getNavigationModel().addKeyBindings({pageUp:A.onKeyPageUp,pageDown:A.onKeyPageDown,scope:A});A.boundList.getSelectionModel().on("selectionchange",A.onSelectChange,A);A.boundList.pickerField=A;if(!A.title){return A.boundList}A.boundList.border=false;return{xtype:"panel",isAriaRegion:false,border:true,anchor:"none 100%",layout:"anchor",title:A.title,tbar:A.tbar,items:A.boundList}},onSelectChange:function(B,A){if(!this.ignoreSelectChange){this.setValue(A)}},getSelected:function(){return this.boundList.getSelectionModel().getSelection()},isEqual:function(D,E){var B=Ext.Array.from,A=0,C;D=B(D);E=B(E);C=D.length;if(C!==E.length){return false}for(;A<C;A++){if(E[A]!==D[A]){return false}}return true},afterRender:function(){var C=this,D=C.boundList,B,A;C.callParent();if(C.selectOnRender){B=C.getRecordsForValue(C.value);if(B.length){++C.ignoreSelectChange;C.boundList.getSelectionModel().select(B);--C.ignoreSelectChange}delete C.toSelect}if(C.ddReorder&&!C.dragGroup&&!C.dropGroup){C.dragGroup=C.dropGroup="MultiselectDD-"+Ext.id()}if(C.draggable||C.dragGroup){C.dragZone=Ext.create("Ext.view.DragZone",{view:C.boundList,ddGroup:C.dragGroup,dragText:C.dragText})}if(C.droppable||C.dropGroup){C.dropZone=Ext.create("Ext.view.DropZone",{view:C.boundList,ddGroup:C.dropGroup,handleNodeDrop:function(K,G,H){var J=this.view,E=J.getStore(),F=K.records,I;K.view.store.remove(F);I=E.indexOf(G);if(H==="after"){I++}E.insert(I,F);J.getSelectionModel().select(F);C.fireEvent("drop",C,F)}})}A=C.down("panel");if(A&&D){D.ariaEl.dom.setAttribute("aria-labelledby",A.header.id+"-title-textEl")}},onKeyPageUp:function(C){var E=this,F=E.pageSize,G=E.boundList,D=G.getNavigationModel(),A,B;A=D.recordIndex;B=A>F?A-F:0;D.setPosition(B,C)},onKeyPageDown:function(A){var G=this,F=G.pageSize,C=G.boundList,B=C.getNavigationModel(),H,E,D;H=C.getStore().getCount();E=B.recordIndex;D=E<(H-F)?E+F:H-1;B.setPosition(D,A)},isValid:function(){var B=this,C=B.disabled,A=B.forceValidation||!C;return A?B.validateValue(B.value):C},validateValue:function(D){var C=this,A=C.getErrors(D),B=Ext.isEmpty(A);if(!C.preventMark){if(B){C.clearInvalid()}else{C.markInvalid(A)}}return B},markInvalid:function(B){var C=this,A=C.getActiveError();C.setActiveErrors(Ext.Array.from(B));if(A!==C.getActiveError()){C.updateLayout()}},clearInvalid:function(){var B=this,A=B.hasActiveError();B.unsetActiveError();if(A){B.updateLayout()}},getSubmitData:function(){var A=this,C=null,B;if(!A.disabled&&A.submitValue&&!A.isFileUpload()){B=A.getSubmitValue();if(B!==null){C={};C[A.getName()]=B}}return C},getSubmitValue:function(){var A=this,C=A.delimiter,B=A.getValue();return Ext.isString(C)?B.join(C):B},getValue:function(){return this.value||[]},getRecordsForValue:function(F){var I=this,E=[],C=I.store.getRange(),H=I.valueField,G=0,A=C.length,B,D,J;for(J=F.length;G<J;++G){for(D=0;D<A;++D){B=C[D];if(B.get(H)==F[G]){E.push(B)}}}return E},setupValue:function(F){var G=this.delimiter,C=this.valueField,A=0,D,E,B;if(Ext.isDefined(F)){if(G&&Ext.isString(F)){F=F.split(G)}else{if(!Ext.isArray(F)){F=[F]}}for(E=F.length;A<E;++A){B=F[A];if(B&&B.isModel){F[A]=B.get(C)}}D=Ext.Array.unique(F)}else{D=[]}return D},setValue:function(C){var B=this,D=B.boundList.getSelectionModel(),A=B.store;if(!A.getCount()){A.on({load:Ext.Function.bind(B.setValue,B,[C]),single:true});return}C=B.setupValue(C);B.mixins.field.setValue.call(B,C);if(B.rendered){++B.ignoreSelectChange;D.deselectAll();if(C.length){D.select(B.getRecordsForValue(C))}--B.ignoreSelectChange}else{B.selectOnRender=true}},clearValue:function(){this.setValue([])},onEnable:function(){var A=this.boundList;this.callParent();if(A){A.enable()}},onDisable:function(){var A=this.boundList;this.callParent();if(A){A.disable()}},getErrors:function(E){var D=this,C=Ext.String.format,B=[],A;E=Ext.Array.from(E||D.getValue());A=E.length;if(!D.allowBlank&&A<1){B.push(D.blankText)}if(A<D.minSelections){B.push(C(D.minSelectionsText,D.minSelections))}if(A>D.maxSelections){B.push(C(D.maxSelectionsText,D.maxSelections))}return B},onDestroy:function(){var A=this;A.bindStore(null);Ext.destroy(A.dragZone,A.dropZone,A.keyNav);A.callParent()},onBindStore:function(A){var B=this.boundList;if(B){B.bindStore(A)}}});Ext.define("Ext.ux.form.ItemSelector",{extend:"Ext.ux.form.MultiSelect",alias:["widget.itemselectorfield","widget.itemselector"],alternateClassName:["Ext.ux.ItemSelector"],requires:["Ext.button.Button","Ext.ux.form.MultiSelect"],hideNavIcons:false,buttons:["top","up","add","remove","down","bottom"],buttonsText:{top:"Move to Top",up:"Move Up",add:"Add to Selected",remove:"Remove from Selected",down:"Move Down",bottom:"Move to Bottom"},layout:{type:"hbox",align:"stretch"},ariaRole:"group",initComponent:function(){var A=this;A.ddGroup=A.id+"-dd";A.ariaRenderAttributes=A.ariaRenderAttributes||{};A.ariaRenderAttributes["aria-labelledby"]=A.id+"-labelEl";A.callParent();A.bindStore(A.store)},createList:function(B){var A=this;return Ext.create("Ext.ux.form.MultiSelect",{submitValue:false,getSubmitData:function(){return null},getModelData:function(){return null},flex:1,dragGroup:A.ddGroup,dropGroup:A.ddGroup,title:B,store:{model:A.store.model,data:[]},displayField:A.displayField,valueField:A.valueField,disabled:A.disabled,listeners:{boundList:{scope:A,itemdblclick:A.onItemDblClick,drop:A.syncValue}}})},setupItems:function(){var A=this;A.fromField=A.createList(A.fromTitle);A.toField=A.createList(A.toTitle);return[A.fromField,{xtype:"toolbar",margin:"0 4",padding:0,layout:{type:"vbox",pack:"center"},items:A.createButtons()},A.toField]},createButtons:function(){var A=this,B=[];if(!A.hideNavIcons){Ext.Array.forEach(A.buttons,function(C){B.push({xtype:"button",ui:"default",tooltip:A.buttonsText[C],ariaLabel:A.buttonsText[C],handler:A["on"+Ext.String.capitalize(C)+"BtnClick"],cls:Ext.baseCSSPrefix+"form-itemselector-btn",iconCls:Ext.baseCSSPrefix+"form-itemselector-"+C,navBtn:true,scope:A,margin:"4 0 0 0"})})}return B},getSelections:function(B){var A=B.getStore();return Ext.Array.sort(B.getSelectionModel().getSelection(),function(D,C){D=A.indexOf(D);C=A.indexOf(C);if(D<C){return -1}else{if(D>C){return 1}}return 0})},onTopBtnClick:function(){var B=this.toField.boundList,A=B.getStore(),C=this.getSelections(B);A.suspendEvents();A.remove(C,true);A.insert(0,C);A.resumeEvents();B.refresh();this.syncValue();B.getSelectionModel().select(C)},onBottomBtnClick:function(){var B=this.toField.boundList,A=B.getStore(),C=this.getSelections(B);A.suspendEvents();A.remove(C,true);A.add(C);A.resumeEvents();B.refresh();this.syncValue();B.getSelectionModel().select(C)},onUpBtnClick:function(){var E=this.toField.boundList,B=E.getStore(),G=this.getSelections(E),A,C=0,F=G.length,D=0;B.suspendEvents();for(;C<F;++C,D++){A=G[C];D=Math.max(D,B.indexOf(A)-1);B.remove(A,true);B.insert(D,A)}B.resumeEvents();E.refresh();this.syncValue();E.getSelectionModel().select(G)},onDownBtnClick:function(){var D=this.toField.boundList,B=D.getStore(),F=this.getSelections(D),A,C=F.length-1,E=B.getCount()-1;B.suspendEvents();for(;C>-1;--C,E--){A=F[C];E=Math.min(E,B.indexOf(A)+1);B.remove(A,true);B.insert(E,A)}B.resumeEvents();D.refresh();this.syncValue();D.getSelectionModel().select(F)},onAddBtnClick:function(){var A=this,B=A.getSelections(A.fromField.boundList);A.moveRec(true,B);A.toField.boundList.getSelectionModel().select(B)},onRemoveBtnClick:function(){var A=this,B=A.getSelections(A.toField.boundList);A.moveRec(false,B);A.fromField.boundList.getSelectionModel().select(B)},moveRec:function(G,E){var D=this,B=D.fromField,A=D.toField,C=G?B.store:A.store,F=G?A.store:B.store;C.suspendEvents();F.suspendEvents();C.remove(E);F.add(E);C.resumeEvents();F.resumeEvents();if(B.boundList.containsFocus){B.boundList.focus()}B.boundList.refresh();A.boundList.refresh();D.syncValue()},syncValue:function(){var A=this;A.mixins.field.setValue.call(A,A.setupValue(A.toField.store.getRange()))},onItemDblClick:function(B,A){this.moveRec(B===this.fromField.boundList,A)},setValue:function(F){var D=this,B=D.fromField,A=D.toField,C=B.store,E=A.store,G;if(!D.fromStorePopulated){D.fromField.store.on({load:Ext.Function.bind(D.setValue,D,[F]),single:true});return}F=D.setupValue(F);D.mixins.field.setValue.call(D,F);G=D.getRecordsForValue(F);C.suspendEvents();E.suspendEvents();C.removeAll();E.removeAll();D.populateFromStore(D.store);Ext.Array.forEach(G,function(H){if(C.indexOf(H)>-1){C.remove(H)}E.add(H)});C.resumeEvents();E.resumeEvents();Ext.suspendLayouts();B.boundList.refresh();A.boundList.refresh();Ext.resumeLayouts(true)},onBindStore:function(A,B){var C=this;if(C.fromField){C.fromField.store.removeAll();C.toField.store.removeAll();if(A.getCount()){C.populateFromStore(A)}else{C.store.on("load",C.populateFromStore,C)}}},populateFromStore:function(A){var B=this.fromField.store;this.fromStorePopulated=true;B.add(A.getRange());B.fireEvent("load",B)},onEnable:function(){var A=this;A.callParent();A.fromField.enable();A.toField.enable();Ext.Array.forEach(A.query("[navBtn]"),function(B){B.enable()})},onDisable:function(){var A=this;A.callParent();A.fromField.disable();A.toField.disable();Ext.Array.forEach(A.query("[navBtn]"),function(B){B.disable()})},onDestroy:function(){this.bindStore(null);this.callParent()}});Ext.define("Ext.ux.form.SearchField",{extend:"Ext.form.field.Text",alias:"widget.searchfield",triggers:{clear:{weight:0,cls:Ext.baseCSSPrefix+"form-clear-trigger",hidden:true,handler:"onClearClick",scope:"this"},search:{weight:1,cls:Ext.baseCSSPrefix+"form-search-trigger",handler:"onSearchClick",scope:"this"}},hasSearch:false,paramName:"query",initComponent:function(){var C=this,A=C.store,B;C.callParent(arguments);C.on("specialkey",function(E,D){if(D.getKey()==D.ENTER){C.onSearchClick()}});if(!A||!A.isStore){A=C.store=Ext.data.StoreManager.lookup(A)}A.setRemoteFilter(true);B=C.store.getProxy();B.setFilterParam(C.paramName);B.encodeFilters=function(D){return D[0].getValue()}},onClearClick:function(){var B=this,A=B.activeFilter;if(A){B.setValue("");B.store.getFilters().remove(A);B.activeFilter=null;B.getTrigger("clear").hide();B.updateLayout()}},onSearchClick:function(){var A=this,B=A.getValue();if(B.length>0){A.activeFilter=new Ext.util.Filter({property:A.paramName,value:B});A.store.getFilters().add(A.activeFilter);A.getTrigger("clear").show();A.updateLayout()}}});Ext.define("Ext.ux.grid.SubTable",{extend:"Ext.grid.plugin.RowExpander",alias:"plugin.subtable",rowBodyTpl:['<table class="'+Ext.baseCSSPrefix+'grid-subtable"><tbody>',"{%","this.owner.renderTable(out, values);","%}","</tbody></table>"],init:function(F){var C=this,B=C.columns,D,A,E;C.callParent(arguments);C.columns=[];if(B){for(A=0,D=B.length;A<D;++A){E=Ext.apply({preventRegister:true},B[A]);E.xtype=E.xtype||"gridcolumn";C.columns.push(Ext.widget(E))}}},destroy:function(){var C=this.columns,B,A;if(C){for(A=0,B=C.length;A<B;++A){C[A].destroy()}}this.columns=null;this.callParent()},getRowBodyFeatureData:function(B,C,A){this.callParent(arguments);A.rowBodyCls+=" "+Ext.baseCSSPrefix+"grid-subtable-row"},renderTable:function(A,G){var J=this,D=J.columns,H=D.length,K=J.getAssociatedRecords(G.record),C=K.length,B,E,I,L,F;A.push("<thead>");for(L=0;L<H;L++){A.push('<th class="'+Ext.baseCSSPrefix+'grid-subtable-header">',D[L].text,"</th>")}A.push("</thead>");for(I=0;I<C;I++){B=K[I];A.push("<tr>");for(L=0;L<H;L++){E=D[L];F=B.get(E.dataIndex);if(E.renderer&&E.renderer.call){F=E.renderer.call(E.scope||J,F,{},B)}A.push('<td class="'+Ext.baseCSSPrefix+'grid-subtable-cell"');if(E.width!=null){A.push(' style="width:'+E.width+'px"')}A.push('><div class="'+Ext.baseCSSPrefix+'grid-cell-inner">',F,"</div></td>")}A.push("</tr>")}},getRowBodyContentsFn:function(B){var A=this;return function(C){B.owner=A;return B.applyTemplate(C)}},getAssociatedRecords:function(A){return A[this.association]().getRange()}});Ext.define("Ext.ux.grid.TransformGrid",{extend:"Ext.grid.Panel",constructor:function(P,B){B=Ext.apply({},B);P=this.table=Ext.get(P);var E=B.fields||[],O=B.columns||[],N=[],G=[],L=P.query("thead th"),I=0,F=L.length,D=P.dom,J,C,K,A,H,M;for(;I<F;++I){A=L[I];H=A.innerHTML;M="tcol-"+I;N.push(Ext.applyIf(E[I]||{},{name:M,mapping:"td:nth("+(I+1)+")/@innerHTML"}));G.push(Ext.applyIf(O[I]||{},{text:H,dataIndex:M,width:A.offsetWidth,tooltip:A.title,sortable:true}))}if(B.width){J=B.width}else{J=P.getWidth()+1}if(B.height){C=B.height}Ext.applyIf(B,{store:{data:D,fields:N,proxy:{type:"memory",reader:{record:"tbody tr",type:"xml"}}},columns:G,width:J,height:C});this.callParent([B]);if(B.remove!==false){D.parentNode.removeChild(D)}},onDestroy:function(){this.callParent();this.table.remove();delete this.table}});Ext.define("Ext.ux.layout.ResponsiveColumn",{extend:"Ext.layout.container.Auto",alias:"layout.responsivecolumn",states:{small:1000,large:0},_responsiveCls:Ext.baseCSSPrefix+"responsivecolumn",initLayout:function(){this.innerCtCls+=" "+this._responsiveCls;this.callParent()},beginLayout:function(B){var F=this,E=Ext.Element.getViewportWidth(),C=F.states,A=Infinity,D=F.innerCt,H=F._currentState,G,I,J;for(G in C){I=C[G]||Infinity;if(E<=I&&I<=A){A=I;J=G}}if(J!==H){D.replaceCls(H,J,F._responsiveCls);F._currentState=J}F.callParent(arguments)},onAdd:function(B){this.callParent([B]);var A=B.responsiveCls;if(A){B.addCls(A)}}},function(A){if(Ext.isIE8){A.override({responsiveSizePolicy:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:0},setsItemSize:true,calculateItems:function(B,E){var K=this,F=B.targetContext,M=B.childItems,G=M.length,L=E.gotWidth,J=E.width,I,O,H,C,D,N;if(L===false){F.domBlock(K,"width");return false}if(!L){return true}for(H=0;H<G;++H){C=M[H];N=parseInt(C.el.getStyle("background-position-x"),10);D=parseInt(C.el.getStyle("background-position-y"),10);C.setWidth((N/100*(J-D))-D)}B.setContentWidth(J+B.paddingContext.getPaddingInfo().width);return true},getItemSizePolicy:function(){return this.responsiveSizePolicy}})}});Ext.define("Ext.ux.rating.Picker",{extend:"Ext.Widget",xtype:"rating",focusable:true,cachedConfig:{family:"monospace",glyphs:"",minimum:1,limit:5,overStyle:null,rounding:1,scale:"125%",selectedStyle:null,tooltip:null,trackOver:true,value:null,tooltipText:null,trackingValue:null},config:{animate:null},element:{cls:"u"+Ext.baseCSSPrefix+"rating-picker",reference:"element",children:[{reference:"innerEl",cls:"u"+Ext.baseCSSPrefix+"rating-picker-inner",listeners:{click:"onClick",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},children:[{reference:"valueEl",cls:"u"+Ext.baseCSSPrefix+"rating-picker-value"},{reference:"trackerEl",cls:"u"+Ext.baseCSSPrefix+"rating-picker-tracker"}]}]},defaultBindProperty:"value",twoWayBindable:"value",overCls:"u"+Ext.baseCSSPrefix+"rating-picker-over",trackOverCls:"u"+Ext.baseCSSPrefix+"rating-picker-track-over",applyGlyphs:function(A){if(typeof A==="string"){if(A.length!==2){Ext.raise('Expected 2 characters for "glyphs" not "'+A+'".')}A=[A.charAt(0),A.charAt(1)]}else{if(typeof A[0]==="number"){A=[String.fromCharCode(A[0]),String.fromCharCode(A[1])]}}return A},applyOverStyle:function(A){this.trackerEl.applyStyles(A)},applySelectedStyle:function(A){this.valueEl.applyStyles(A)},applyTooltip:function(A){if(A&&typeof A!=="function"){if(!A.isTemplate){A=new Ext.XTemplate(A)}A=A.apply.bind(A)}return A},applyTrackingValue:function(A){return this.applyValue(A)},applyValue:function(C){if(C!==null){var B=this.getRounding(),D=this.getLimit(),A=this.getMinimum();C=Math.round(Math.round(C/B)*B*1000)/1000;C=(C<A)?A:(C>D?D:C)}return C},onClick:function(A){var B=this.valueFromEvent(A);this.setValue(B)},onMouseEnter:function(){this.element.addCls(this.overCls)},onMouseLeave:function(){this.element.removeCls(this.overCls)},onMouseMove:function(A){var B=this.valueFromEvent(A);this.setTrackingValue(B)},updateFamily:function(A){this.element.setStyle("fontFamily","'"+A+"'")},updateGlyphs:function(){this.refreshGlyphs()},updateLimit:function(){this.refreshGlyphs()},updateScale:function(A){this.element.setStyle("fontSize",A)},updateTooltip:function(){this.refreshTooltip()},updateTooltipText:function(B){var E=this.innerEl,C=Ext.tip&&Ext.tip.QuickTipManager,A=C&&C.tip,D;if(C){E.dom.setAttribute("data-qtip",B);this.trackerEl.dom.setAttribute("data-qtip",B);D=A&&A.activeTarget;D=D&&D.el;if(D&&E.contains(D)){A.update(B)}}},updateTrackingValue:function(C){var A=this,D=A.trackerEl,B=A.valueToPercent(C);D.setStyle("width",B);A.refreshTooltip()},updateTrackOver:function(A){this.element[A?"addCls":"removeCls"](this.trackOverCls)},updateValue:function(D,E){var F=this,C=F.getAnimate(),B=F.valueEl,H=F.valueToPercent(D),A,G;if(F.isConfiguring||!C){B.setStyle("width",H)}else{B.stopAnimation();B.animate(Ext.merge({from:{width:F.valueToPercent(E)},to:{width:H}},C))}F.refreshTooltip();if(!F.isConfiguring){if(F.hasListeners.change){F.fireEvent("change",F,D,E)}A=F.getWidgetColumn&&F.getWidgetColumn();G=A&&F.getWidgetRecord&&F.getWidgetRecord();if(G&&A.dataIndex){G.set(A.dataIndex,D)}}},afterCachedConfig:function(){this.refresh();return this.callParent(arguments)},initConfig:function(A){this.isConfiguring=true;this.callParent([A]);this.refresh()},setConfig:function(){var A=this;A.isReconfiguring=true;A.callParent(arguments);A.isReconfiguring=false;A.refresh();return A},destroy:function(){this.tip=Ext.destroy(this.tip);this.callParent()},privates:{getGlyphTextNode:function(A){var B=A.lastChild;if(!B||B.nodeType!==3){B=A.ownerDocument.createTextNode("");A.appendChild(B)}return B},getTooltipData:function(){var A=this;return{component:A,tracking:A.getTrackingValue(),trackOver:A.getTrackOver(),value:A.getValue()}},refresh:function(){var A=this;if(A.invalidGlyphs){A.refreshGlyphs(true)}if(A.invalidTooltip){A.refreshTooltip(true)}},refreshGlyphs:function(A){var I=this,G=!A&&(I.isConfiguring||I.isReconfiguring),F,E,B,D,J,C,H;if(!G){F=I.getGlyphTextNode(I.innerEl.dom);H=I.getGlyphTextNode(I.valueEl.dom);C=I.getGlyphTextNode(I.trackerEl.dom);E=I.getGlyphs();B=I.getLimit();for(D=J="";B--;){J+=E[0];D+=E[1]}F.nodeValue=J;H.nodeValue=D;C.nodeValue=D}I.invalidGlyphs=G},refreshTooltip:function(E){var B=this,A=!E&&(B.isConfiguring||B.isReconfiguring),C=B.getTooltip(),F,D;if(!A){C=B.getTooltip();if(C){F=B.getTooltipData();D=C(F);B.setTooltipText(D)}}B.invalidTooltip=A},valueFromEvent:function(E){var I=this,F=I.innerEl,H=E.getX(),D=I.getRounding(),G=F.getX(),J=H-G,C=F.getWidth(),A=I.getLimit(),B;if(I.getInherited().rtl){J=C-J}B=J/C*A;B=Math.ceil(B/D)*D;return B},valueToPercent:function(A){A=(A/this.getLimit())*100;return A+"%"}}});Ext.define("Ext.ux.statusbar.ValidationStatus",{extend:"Ext.Component",requires:["Ext.util.MixedCollection"],errorIconCls:"x-status-error",errorListCls:"x-status-error-list",validIconCls:"x-status-valid",showText:"The form has errors (click for details...)",hideText:"Click again to hide the error list",submitText:"Saving...",init:function(B){var A=this;A.statusBar=B;B.on({single:true,scope:A,render:A.onStatusbarRender,beforedestroy:A.destroy});B.on({click:{element:"el",fn:A.onStatusClick,scope:A,buffer:200}})},onStatusbarRender:function(C){var B=this,A=function(){B.monitor=true};B.monitor=true;B.errors=Ext.create("Ext.util.MixedCollection");B.listAlign=(C.statusAlign==="right"?"br-tr?":"bl-tl?");if(B.form){B.formPanel=Ext.getCmp(B.form);B.basicForm=B.formPanel.getForm();B.startMonitoring();B.basicForm.on("beforeaction",function(E,D){if(D.type==="submit"){B.monitor=false}});B.basicForm.on("actioncomplete",A);B.basicForm.on("actionfailed",A)}},startMonitoring:function(){this.basicForm.getFields().each(function(A){A.on("validitychange",this.onFieldValidation,this)},this)},stopMonitoring:function(){this.basicForm.getFields().each(function(A){A.un("validitychange",this.onFieldValidation,this)},this)},onDestroy:function(){this.stopMonitoring();this.statusBar.statusEl.un("click",this.onStatusClick,this);this.callParent(arguments)},onFieldValidation:function(D,B){var A=this,C;if(!A.monitor){return false}C=D.getErrors()[0];if(C){A.errors.add(D.id,{field:D,msg:C})}else{A.errors.removeAtKey(D.id)}this.updateErrorList();if(A.errors.getCount()>0){if(A.statusBar.getText()!==A.showText){A.statusBar.setStatus({text:A.showText,iconCls:A.errorIconCls})}}else{A.statusBar.clearStatus().setIcon(A.validIconCls)}},updateErrorList:function(){var A=this,C,B=A.getMsgEl();if(A.errors.getCount()>0){C=["<ul>"];this.errors.each(function(D){C.push('<li id="x-err-',D.field.id,'"><a href="#">',D.msg,"</a></li>")});C.push("</ul>");B.update(C.join(""))}else{B.update("")}B.setSize("auto","auto")},getMsgEl:function(){var A=this,C=A.msgEl,B;if(!C){C=A.msgEl=Ext.DomHelper.append(Ext.getBody(),{cls:A.errorListCls},true);C.hide();C.on("click",function(D){B=D.getTarget("li",10,true);if(B){Ext.getCmp(B.id.split("x-err-")[1]).focus();A.hideErrors()}},null,{stopEvent:true})}return C},showErrors:function(){var A=this;A.updateErrorList();A.getMsgEl().alignTo(A.statusBar.getEl(),A.listAlign).slideIn("b",{duration:300,easing:"easeOut"});A.statusBar.setText(A.hideText);A.formPanel.body.on("click",A.hideErrors,A,{single:true})},hideErrors:function(){var A=this.getMsgEl();if(A.isVisible()){A.slideOut("b",{duration:300,easing:"easeIn"});this.statusBar.setText(this.showText)}this.formPanel.body.un("click",this.hideErrors,this)},onStatusClick:function(){if(this.getMsgEl().isVisible()){this.hideErrors()}else{if(this.errors.getCount()>0){this.showErrors()}}}});